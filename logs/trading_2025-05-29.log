D:\anaconda\python.exe D:\sam_bnb_futures_limit_order\main_sam_new.py
2025-05-29 15:34:22,029 - TradingBot - INFO - 日志初始化成功，当前日志文件: logs\trading_2025-05-29.log
2025-05-29 15:34:22,029 - TradingBot - INFO - 交易程序启动，进入日内多次换仓模式
2025-05-29 15:34:22,331 - TradingBot - INFO - Binance 客户端初始化成功，测试网络: False
2025-05-29 15:34:22,683 - TradingBot - INFO - 所有交易对已是全仓模式 (CROSSED)，无需修改
2025-05-29 15:34:22,803 - TradingBot - INFO - 账户已是单币种模式 (Single)，无需修改
2025-05-29 15:34:22,931 - TradingBot - INFO - 账户已是单向模式 (One-way)，无需修改
2025-05-29 15:34:23,439 - TradingBot - INFO - 检查 20250529 的文件或邮件，Run_ID: 2025-05-29_1534:23
2025-05-29 15:34:23,439 - TradingBot - INFO - 检查本地 data/pos20250529_v3.csv：data/pos20250529_v3.csv
2025-05-29 15:34:23,439 - TradingBot - INFO - 本地找到文件 data/pos20250529_v3.csv，哈希值: f15f859a3ed30157e3a3be2755a85d1b，未处理，直接使用
2025-05-29 15:34:23,439 - TradingBot - INFO - 处理 20250529 的pos文件，Run_ID:： 2025-05-29_1534:23
2025-05-29 15:34:23,439 - TradingBot - INFO - 🚀 开始执行交易引擎 | Date: 20250529 | RunID: 2025-05-29_1534:23
2025-05-29 15:34:23,587 - TradingBot - INFO - 当前没有未成交的挂单
2025-05-29 15:34:23,590 - TradingBot - INFO - 📋 黑名单过滤结果
├─ 被过滤币种 (7个): BADGERUSDT, BALUSDT, LINAUSDT, NULSUSDT, SNTUSDT, TROYUSDT, VIDTUSDT
└─ 剩余候选池: 166/173
2025-05-29 15:34:23,598 - TradingBot - INFO - 🔍 有效候选列表
├─ 多头候选: 82个
└─ 空头候选: 84个
2025-05-29 15:34:23,916 - TradingBot - INFO - =====账户信息获取成功: totalMarginBalance = 48.07547531, available_balance = 6.02660723=====
2025-05-29 15:34:23,916 - TradingBot - INFO - 每笔交易资金份额: per_share=3.076819665
2025-05-29 15:34:24,072 - TradingBot - INFO - 获取到 14 个非零持仓
2025-05-29 15:34:24,072 - TradingBot - INFO - 当前持仓: {'TRXUSDT': 34.0, 'PROMUSDT': 1.7, 'CRVUSDT': -11.6, 'FLMUSDT': -195.0, 'OMUSDT': -23.5, 'MKRUSDT': 0.005, 'DOGEUSDT': 41.0, 'DASHUSDT': -0.368, 'KAVAUSDT': 21.8, 'IOSTUSDT': 2382.0, 'AERGOUSDT': -60.0, 'XRPUSDT': 4.0, 'DFUSDT': -177.0, 'CAKEUSDT': -3.0}, 是否第一天: False
2025-05-29 15:34:24,261 - TradingBot - INFO - 交易所信息获取成功
2025-05-29 15:34:25,193 - TradingBot - WARNING - BTCUSDT 数量调整为 0 (原值: 0 小于最小值: 0.001)
2025-05-29 15:34:25,193 - TradingBot - WARNING - BTCUSDT 数量调整为 0 (因名义价值 0.0 小于最小值 100.0)
2025-05-29 15:34:25,193 - TradingBot - INFO - BTCUSDT 数量调整: 8.557576736230218e-05 -> 0, 最小值: 0.001, 最大值: 1000.0, 名义价值=0.0, 真实保证金=0.000000, 数量精度=3
2025-05-29 15:34:25,195 - TradingBot - WARNING - BTCUSDT 数量调整为 0，跳过
2025-05-29 15:34:25,749 - TradingBot - INFO - MKRUSDT 数量调整: 0.005277563747855918 -> 0.005, 最小值: 0.001, 最大值: 10000.0, 名义价值=8.745000000000001, 真实保证金=2.915000, 数量精度=3
2025-05-29 15:34:25,750 - TradingBot - INFO - 添加多头目标: MKRUSDT, 数量=0.005
2025-05-29 15:34:26,305 - TradingBot - INFO - DOGEUSDT 数量调整: 41.08451949525971 -> 41.0, 最小值: 1.0, 最大值: 50000000.0, 名义价值=9.21147, 真实保证金=3.070490, 数量精度=0
2025-05-29 15:34:26,306 - TradingBot - INFO - 添加多头目标: DOGEUSDT, 数量=41.0
2025-05-29 15:34:26,829 - TradingBot - INFO - KAVAUSDT 数量调整: 21.84724022485207 -> 21.8, 最小值: 0.1, 最大值: 1000000.0, 名义价值=9.2105, 真实保证金=3.070167, 数量精度=1
2025-05-29 15:34:26,830 - TradingBot - INFO - 添加多头目标: KAVAUSDT, 数量=21.8
2025-05-29 15:34:26,830 - TradingBot - WARNING - 交易对 KEYUSDT 不可交易，跳过
2025-05-29 15:34:26,830 - TradingBot - WARNING - 交易对 STPTUSDT 不可交易，跳过
2025-05-29 15:34:26,830 - TradingBot - WARNING - 交易对 AMBUSDT 不可交易，跳过
2025-05-29 15:34:26,830 - TradingBot - WARNING - 交易对 REEFUSDT 不可交易，跳过
2025-05-29 15:34:26,830 - TradingBot - WARNING - 交易对 SCUSDT 不可交易，跳过
2025-05-29 15:34:27,344 - TradingBot - INFO - TRXUSDT 数量调整: 33.515337115573146 -> 34.0, 最小值: 1.0, 最大值: 10000000.0, 名义价值=9.36394, 真实保证金=3.121313, 数量精度=0
2025-05-29 15:34:27,346 - TradingBot - INFO - 添加多头目标: TRXUSDT, 数量=34.0
2025-05-29 15:34:27,346 - TradingBot - WARNING - 交易对 SLPUSDT 不可交易，跳过
2025-05-29 15:34:27,346 - TradingBot - WARNING - 交易对 DGBUSDT 不可交易，跳过
2025-05-29 15:34:27,346 - TradingBot - WARNING - 交易对 MDTUSDT 不可交易，跳过
2025-05-29 15:34:27,346 - TradingBot - WARNING - 交易对 RENUSDT 不可交易，跳过
2025-05-29 15:34:27,848 - TradingBot - INFO - IOSTUSDT 数量调整: 2380.8251212277532 -> 2381.0, 最小值: 1.0, 最大值: 80000000.0, 名义价值=9.231137, 真实保证金=3.077046, 数量精度=0
2025-05-29 15:34:27,848 - TradingBot - INFO - 添加多头目标: IOSTUSDT, 数量=2381.0
2025-05-29 15:34:28,347 - TradingBot - INFO - PROMUSDT 数量调整: 1.7217793312814773 -> 1.7, 最小值: 0.1, 最大值: 100000.0, 名义价值=9.1137, 真实保证金=3.037900, 数量精度=1
2025-05-29 15:34:28,347 - TradingBot - INFO - 添加多头目标: PROMUSDT, 数量=1.7
2025-05-29 15:34:29,137 - TradingBot - INFO - XRPUSDT 数量调整: 4.045076030939129 -> 4.0, 最小值: 0.1, 最大值: 10000000.0, 名义价值=9.1276, 真实保证金=3.042533, 数量精度=1
2025-05-29 15:34:29,138 - TradingBot - INFO - 添加多头目标: XRPUSDT, 数量=4.0
2025-05-29 15:34:29,646 - TradingBot - INFO - AERGOUSDT 数量调整: 63.58817163819233 -> 64.0, 最小值: 1.0, 最大值: 4000000.0, 名义价值=9.29024, 真实保证金=3.096747, 数量精度=0
2025-05-29 15:34:29,648 - TradingBot - INFO - 添加空头目标: AERGOUSDT, 数量=-64.0
2025-05-29 15:34:30,151 - TradingBot - INFO - FLMUSDT 数量调整: 193.10583671548116 -> 193.0, 最小值: 1.0, 最大值: 15000000.0, 名义价值=9.2254, 真实保证金=3.075133, 数量精度=0
2025-05-29 15:34:30,152 - TradingBot - INFO - 添加空头目标: FLMUSDT, 数量=-193.0
2025-05-29 15:34:30,683 - TradingBot - INFO - OMUSDT 数量调整: 23.539883186269506 -> 23.5, 最小值: 0.1, 最大值: 10000000.0, 名义价值=9.214820000000001, 真实保证金=3.071607, 数量精度=1
2025-05-29 15:34:30,684 - TradingBot - INFO - 添加空头目标: OMUSDT, 数量=-23.5
2025-05-29 15:34:31,192 - TradingBot - INFO - DASHUSDT 数量调整: 0.3884873314393939 -> 0.388, 最小值: 0.001, 最大值: 10000.0, 名义价值=9.21888, 真实保证金=3.072960, 数量精度=3
2025-05-29 15:34:31,193 - TradingBot - INFO - 添加空头目标: DASHUSDT, 数量=-0.388
2025-05-29 15:34:31,694 - TradingBot - INFO - CRVUSDT 数量调整: 11.788581091954022 -> 11.8, 最小值: 0.1, 最大值: 1000000.0, 名义价值=9.239400000000002, 真实保证金=3.079800, 数量精度=1
2025-05-29 15:34:31,695 - TradingBot - INFO - 添加空头目标: CRVUSDT, 数量=-11.8
2025-05-29 15:34:32,206 - TradingBot - INFO - CAKEUSDT 数量调整: 3.3979234290447264 -> 3.0, 最小值: 1.0, 最大值: 1000000.0, 名义价值=8.1495, 真实保证金=2.716500, 数量精度=0
2025-05-29 15:34:32,206 - TradingBot - INFO - 添加空头目标: CAKEUSDT, 数量=-3.0
2025-05-29 15:34:32,855 - TradingBot - WARNING - BCHUSDT 数量调整为 0 (因名义价值 9.29984 小于最小值 20.0)
2025-05-29 15:34:32,855 - TradingBot - INFO - BCHUSDT 数量调整: 0.021835870067657075 -> 0, 最小值: 0.001, 最大值: 10000.0, 名义价值=0.0, 真实保证金=0.000000, 数量精度=3
2025-05-29 15:34:32,856 - TradingBot - WARNING - BCHUSDT 数量调整为 0，跳过
2025-05-29 15:34:33,369 - TradingBot - INFO - DFUSDT 数量调整: 184.31427705670924 -> 184.0, 最小值: 1.0, 最大值: 5000000.0, 名义价值=9.21472, 真实保证金=3.071573, 数量精度=0
2025-05-29 15:34:33,370 - TradingBot - INFO - 添加空头目标: DFUSDT, 数量=-184.0
2025-05-29 15:34:33,370 - TradingBot - INFO - 初始化目标持仓: {'MKRUSDT': 0.005, 'DOGEUSDT': 41.0, 'KAVAUSDT': 21.8, 'TRXUSDT': 34.0, 'IOSTUSDT': 2381.0, 'PROMUSDT': 1.7, 'XRPUSDT': 4.0, 'AERGOUSDT': -64.0, 'FLMUSDT': -193.0, 'OMUSDT': -23.5, 'DASHUSDT': -0.388, 'CRVUSDT': -11.8, 'CAKEUSDT': -3.0, 'DFUSDT': -184.0}
2025-05-29 15:34:33,515 - TradingBot - INFO - 获取到 14 个非零持仓
2025-05-29 15:34:33,516 - TradingBot - INFO - ==================== 开始持续限价单调仓 ====================
2025-05-29 15:34:33,516 - TradingBot - INFO - 开始第 1 轮调仓...
2025-05-29 15:34:33,661 - TradingBot - INFO - 第 1 轮开始时可用余额: 6.04090023
2025-05-29 15:34:33,805 - TradingBot - INFO - 第 1 轮: 处理平仓 IOSTUSDT SELL, 需求数量=1.0
2025-05-29 15:34:34,287 - TradingBot - INFO - IOSTUSDT 平仓数量调整: 1.0 -> 1.0, 最小值: 1.0, 最大值: 80000000.0, 名义价值=0.003877, 真实保证金=0.001292, 数量精度=0
2025-05-29 15:34:34,288 - TradingBot - INFO - 第 1 轮: IOSTUSDT 平仓调整后数量=1.0
2025-05-29 15:34:34,289 - TradingBot - INFO - 第 1 轮: IOSTUSDT 为平仓操作，跳过余额检查
2025-05-29 15:34:34,420 - TradingBot - INFO - 第 1 轮: 准备平仓挂单 IOSTUSDT SELL, 数量=1.0, 价格=0.003877, is_close=True
2025-05-29 15:34:34,569 - TradingBot - INFO - IOSTUSDT 杠杆设置为 3
2025-05-29 15:34:34,569 - TradingBot - INFO - IOSTUSDT 杠杆已设置为 3, is_close=True
2025-05-29 15:34:34,749 - TradingBot - INFO - IOSTUSDT 为平仓订单 (reduceOnly=True)，跳过保证金检查
2025-05-29 15:34:34,883 - TradingBot - INFO - IOSTUSDT postonly 挂单成功: 方向=SELL, 数量=1.0, 价格=0.003877, 订单ID=8218138592, is_close=True, reduceOnly=True
2025-05-29 15:34:35,028 - TradingBot - INFO - 第 1 轮: IOSTUSDT 平仓挂单结果 success=True, order_id=8218138592, order={'orderId': 8218138592, 'symbol': 'IOSTUSDT', 'status': 'NEW', 'clientOrderId': 'x-Cb7ytekJe6167ba096c2e3cd926aa0', 'price': '0.003877', 'avgPrice': '0.00', 'origQty': '1', 'executedQty': '0', 'cumQty': '0', 'cumQuote': '0.000000', 'timeInForce': 'GTX', 'type': 'LIMIT', 'reduceOnly': True, 'closePosition': False, 'side': 'SELL', 'positionSide': 'BOTH', 'stopPrice': '0.000000', 'workingType': 'CONTRACT_PRICE', 'priceProtect': False, 'origType': 'LIMIT', 'priceMatch': 'NONE', 'selfTradePreventionMode': 'EXPIRE_MAKER', 'goodTillDate': 0, 'updateTime': 1748504074827}
2025-05-29 15:34:35,028 - TradingBot - INFO - 第 1 轮: IOSTUSDT SELL postOnly 平仓挂单成功，订单ID=8218138592, is_close=True
2025-05-29 15:34:35,028 - TradingBot - INFO - 第 1 轮: 处理平仓 FLMUSDT BUY, 需求数量=2.0
2025-05-29 15:34:35,504 - TradingBot - INFO - FLMUSDT 平仓数量调整: 2.0 -> 2.0, 最小值: 1.0, 最大值: 15000000.0, 名义价值=0.0954, 真实保证金=0.031800, 数量精度=0
2025-05-29 15:34:35,506 - TradingBot - INFO - 第 1 轮: FLMUSDT 平仓调整后数量=2.0
2025-05-29 15:34:35,506 - TradingBot - INFO - 第 1 轮: FLMUSDT 为平仓操作，跳过余额检查
2025-05-29 15:34:35,652 - TradingBot - INFO - 第 1 轮: 准备平仓挂单 FLMUSDT BUY, 数量=2.0, 价格=0.0477, is_close=True
2025-05-29 15:34:35,800 - TradingBot - INFO - FLMUSDT 杠杆设置为 3
2025-05-29 15:34:35,800 - TradingBot - INFO - FLMUSDT 杠杆已设置为 3, is_close=True
2025-05-29 15:34:35,976 - TradingBot - INFO - FLMUSDT 为平仓订单 (reduceOnly=True)，跳过保证金检查
2025-05-29 15:34:36,132 - TradingBot - INFO - FLMUSDT postonly 挂单成功: 方向=BUY, 数量=2.0, 价格=0.0477, 订单ID=8392365630, is_close=True, reduceOnly=True
2025-05-29 15:34:36,272 - TradingBot - INFO - 第 1 轮: FLMUSDT 平仓挂单结果 success=True, order_id=8392365630, order={'orderId': 8392365630, 'symbol': 'FLMUSDT', 'status': 'NEW', 'clientOrderId': 'x-Cb7ytekJ9ff6e22bcd9b3a3da4a634', 'price': '0.0477', 'avgPrice': '0.00', 'origQty': '2', 'executedQty': '0', 'cumQty': '0', 'cumQuote': '0.0000', 'timeInForce': 'GTX', 'type': 'LIMIT', 'reduceOnly': True, 'closePosition': False, 'side': 'BUY', 'positionSide': 'BOTH', 'stopPrice': '0.0000', 'workingType': 'CONTRACT_PRICE', 'priceProtect': False, 'origType': 'LIMIT', 'priceMatch': 'NONE', 'selfTradePreventionMode': 'EXPIRE_MAKER', 'goodTillDate': 0, 'updateTime': 1748504076066}
2025-05-29 15:34:36,272 - TradingBot - INFO - 第 1 轮: FLMUSDT BUY postOnly 平仓挂单成功，订单ID=8392365630, is_close=True
2025-05-29 15:34:36,272 - TradingBot - INFO - 第 1 轮开仓前可用余额: 6.04090023, 开仓需求: {'IOSTUSDT': 0.0, 'DASHUSDT': -0.020000000000000018, 'CRVUSDT': -0.20000000000000107, 'FLMUSDT': 0.0, 'DFUSDT': -7.0, 'AERGOUSDT': -4.0}
2025-05-29 15:34:36,272 - TradingBot - INFO - 第 1 轮: 跳过 IOSTUSDT 开仓，原因：数量为0或已处理
2025-05-29 15:34:36,272 - TradingBot - INFO - 第 1 轮: 处理开仓 DASHUSDT SELL, 需求数量=-0.020000000000000018
2025-05-29 15:34:36,826 - TradingBot - WARNING - DASHUSDT 数量调整为 0 (因名义价值 0.4754 小于最小值 5.0)
2025-05-29 15:34:36,827 - TradingBot - INFO - DASHUSDT 数量调整: 0.020000000000000018 -> 0, 最小值: 0.001, 最大值: 10000.0, 名义价值=0.0, 真实保证金=0.000000, 数量精度=3
2025-05-29 15:34:36,827 - TradingBot - INFO - 第 1 轮: DASHUSDT 开仓调整后数量=0, is_reverse_open=False
2025-05-29 15:34:36,827 - TradingBot - WARNING - 第 1 轮: DASHUSDT 调整数量为 0，跳过
2025-05-29 15:34:36,827 - TradingBot - INFO - 第 1 轮: 处理开仓 CRVUSDT SELL, 需求数量=-0.20000000000000107
2025-05-29 15:34:37,328 - TradingBot - WARNING - CRVUSDT 数量调整为 0 (因名义价值 0.15660000000000002 小于最小值 5.0)
2025-05-29 15:34:37,329 - TradingBot - INFO - CRVUSDT 数量调整: 0.20000000000000107 -> 0, 最小值: 0.1, 最大值: 1000000.0, 名义价值=0.0, 真实保证金=0.000000, 数量精度=1
2025-05-29 15:34:37,330 - TradingBot - INFO - 第 1 轮: CRVUSDT 开仓调整后数量=0, is_reverse_open=False
2025-05-29 15:34:37,330 - TradingBot - WARNING - 第 1 轮: CRVUSDT 调整数量为 0，跳过
2025-05-29 15:34:37,330 - TradingBot - INFO - 第 1 轮: 跳过 FLMUSDT 开仓，原因：数量为0或已处理
2025-05-29 15:34:37,330 - TradingBot - INFO - 第 1 轮: 处理开仓 DFUSDT SELL, 需求数量=-7.0
2025-05-29 15:34:37,803 - TradingBot - WARNING - DFUSDT 数量调整为 0 (因名义价值 0.35056000000000004 小于最小值 5.0)
2025-05-29 15:34:37,803 - TradingBot - INFO - DFUSDT 数量调整: 7.0 -> 0, 最小值: 1.0, 最大值: 5000000.0, 名义价值=0.0, 真实保证金=0.000000, 数量精度=0
2025-05-29 15:34:37,803 - TradingBot - INFO - 第 1 轮: DFUSDT 开仓调整后数量=0, is_reverse_open=False
2025-05-29 15:34:37,803 - TradingBot - WARNING - 第 1 轮: DFUSDT 调整数量为 0，跳过
2025-05-29 15:34:37,804 - TradingBot - INFO - 第 1 轮: 处理开仓 AERGOUSDT SELL, 需求数量=-4.0
2025-05-29 15:34:38,291 - TradingBot - WARNING - AERGOUSDT 数量调整为 0 (因名义价值 0.5806800000000001 小于最小值 5.0)
2025-05-29 15:34:38,291 - TradingBot - INFO - AERGOUSDT 数量调整: 4.0 -> 0, 最小值: 1.0, 最大值: 4000000.0, 名义价值=0.0, 真实保证金=0.000000, 数量精度=0
2025-05-29 15:34:38,292 - TradingBot - INFO - 第 1 轮: AERGOUSDT 开仓调整后数量=0, is_reverse_open=False
2025-05-29 15:34:38,292 - TradingBot - WARNING - 第 1 轮: AERGOUSDT 调整数量为 0，跳过
2025-05-29 15:34:38,292 - TradingBot - INFO - 第 1 轮挂单等待，最多 30 秒...
2025-05-29 15:34:50,062 - TradingBot - INFO - 第 1 轮: IOSTUSDT SELL 单已成交，订单ID=8218138592, 成交数量=1.0, 均价=0.003877
2025-05-29 15:34:50,062 - TradingBot - INFO - 第 1 轮: IOSTUSDT SELL 已完全成交，订单ID=8218138592, 成交数量=1.0
2025-05-29 15:35:09,443 - TradingBot - INFO - 第 1 轮结束，取消所有未成交挂单...
2025-05-29 15:35:09,571 - TradingBot - INFO - 第 1 轮: 发现 1 个未成交订单
2025-05-29 15:35:09,711 - TradingBot - INFO - 成功取消 FLMUSDT 订单，订单ID=8392365630
2025-05-29 15:35:09,711 - TradingBot - INFO - 第 1 轮: 成功取消 FLMUSDT BUY 挂单，订单ID=8392365630
2025-05-29 15:35:09,858 - TradingBot - INFO - 获取到 14 个非零持仓
2025-05-29 15:35:10,565 - TradingBot - INFO - DASHUSDT 平仓数量调整: 0.020000000000000018 -> 0.02, 最小值: 0.001, 最大值: 10000.0, 名义价值=0.47520000000000007, 真实保证金=0.158400, 数量精度=3
2025-05-29 15:35:10,567 - TradingBot - INFO - 第 1 轮: DASHUSDT 差值 -0.020000000000000018 为小额调整（名义价值 0.47520000000000007 < 5 或数量过小），跳过后续轮次
2025-05-29 15:35:11,061 - TradingBot - INFO - CRVUSDT 平仓数量调整: 0.20000000000000107 -> 0.2, 最小值: 0.1, 最大值: 1000000.0, 名义价值=0.15680000000000002, 真实保证金=0.052267, 数量精度=1
2025-05-29 15:35:11,062 - TradingBot - INFO - 第 1 轮: CRVUSDT 差值 -0.20000000000000107 为小额调整（名义价值 0.15680000000000002 < 5 或数量过小），跳过后续轮次
2025-05-29 15:35:11,655 - TradingBot - INFO - FLMUSDT 平仓数量调整: 2.0 -> 2.0, 最小值: 1.0, 最大值: 15000000.0, 名义价值=0.0956, 真实保证金=0.031867, 数量精度=0
2025-05-29 15:35:11,657 - TradingBot - INFO - 第 1 轮: FLMUSDT 差值 2.0 为小额调整（名义价值 0.0956 < 5 或数量过小），跳过后续轮次
2025-05-29 15:35:12,524 - TradingBot - INFO - DFUSDT 平仓数量调整: 7.0 -> 7.0, 最小值: 1.0, 最大值: 5000000.0, 名义价值=0.35063, 真实保证金=0.116877, 数量精度=0
2025-05-29 15:35:12,524 - TradingBot - INFO - 第 1 轮: DFUSDT 差值 -7.0 为小额调整（名义价值 0.35063 < 5 或数量过小），跳过后续轮次
2025-05-29 15:35:13,330 - TradingBot - INFO - AERGOUSDT 平仓数量调整: 4.0 -> 4.0, 最小值: 1.0, 最大值: 4000000.0, 名义价值=0.58064, 真实保证金=0.193547, 数量精度=0
2025-05-29 15:35:13,331 - TradingBot - INFO - 第 1 轮: AERGOUSDT 差值 -4.0 为小额调整（名义价值 0.58064 < 5 或数量过小），跳过后续轮次
2025-05-29 15:35:13,331 - TradingBot - INFO - 第 1 轮完成，剩余需求: {}
2025-05-29 15:35:13,331 - TradingBot - INFO - 第 1 轮后所有目标已达成，结束限价单调仓
2025-05-29 15:35:13,331 - TradingBot - INFO - ==================== 市价单补齐：后续调仓 ====================
2025-05-29 15:35:13,694 - TradingBot - INFO - 获取到 14 个非零持仓
2025-05-29 15:35:13,694 - TradingBot - INFO - 市价单补齐：所有目标已达成，无需补齐
2025-05-29 15:35:37,810 - TradingBot - INFO - 账户信息已保存为JSON文件: data/account_info_20250529_153537.json
2025-05-29 15:35:37,818 - TradingBot - INFO - account_metrics.xlsx 为空或不存在，回报率设为 0
2025-05-29 15:35:38,398 - TradingBot - INFO - 成功写入 14 条指标到 data/account_metrics.xlsx，Run_ID=2025-05-29_1534:23
2025-05-29 15:35:38,398 - TradingBot - INFO - ✅ 交易引擎执行完成 | RunID: 2025-05-29_1534:23
2025-05-29 15:35:38,399 - TradingBot - INFO - 当前日期: 2025-05-29, Run_ID: 2025-05-29_1534:23
2025-05-29 15:35:38,401 - TradingBot - INFO - 读取 data/positions_output.csv，去重后包含 123 条记录
2025-05-29 15:35:38,402 - TradingBot - INFO - 找到 0 条 Run_ID=2025-05-29_1534:23 或日期=2025-05-29 的记录
2025-05-29 15:35:38,402 - TradingBot - INFO - 当前 Run_ID 无持仓数据，创建空结果
2025-05-29 15:35:38,402 - TradingBot - INFO - 正持仓数量: 0, 负持仓数量: 0
2025-05-29 15:35:38,403 - TradingBot - INFO - 资金费率文件 data/pos20250529_v3.csv 已加载，去重后包含 173 条记录
2025-05-29 15:35:38,405 - TradingBot - INFO - 已为 7 个黑名单币种设置 ErrorReason: 黑名单过滤
2025-05-29 15:35:38,405 - TradingBot - ERROR - 已筛选出 16 个币种映射错误原因
2025-05-29 15:35:38,406 - TradingBot - INFO - 已为 16 个币种映射其他错误原因
2025-05-29 15:35:38,408 - TradingBot - INFO - 无有效持仓数据，生成空结果
2025-05-29 15:35:38,429 - TradingBot - ERROR - 交易程序发生异常: Index(['ID'], dtype='object')
2025-05-29 15:35:38,430 - TradingBot - CRITICAL - 交易程序发生异常: Index(['ID'], dtype='object')

2025-05-29 15:57:29,329 - TradingBot - INFO - 日志初始化成功，当前日志文件: logs\trading_2025-05-29.log
2025-05-29 15:57:29,329 - TradingBot - INFO - 交易程序启动，进入日内多次换仓模式
2025-05-29 15:57:29,690 - TradingBot - INFO - Binance 客户端初始化成功，测试网络: False
2025-05-29 15:57:30,036 - TradingBot - INFO - 所有交易对已是全仓模式 (CROSSED)，无需修改
2025-05-29 15:57:30,211 - TradingBot - INFO - 账户已是单币种模式 (Single)，无需修改
2025-05-29 15:57:30,417 - TradingBot - INFO - 账户已是单向模式 (One-way)，无需修改
2025-05-29 15:57:30,883 - TradingBot - INFO - 检查 20250529 的文件或邮件，Run_ID: 2025-05-29_1557:30
2025-05-29 15:57:30,883 - TradingBot - INFO - 检查本地 data/pos20250529_v3.csv：data/pos20250529_v3.csv
2025-05-29 15:57:30,884 - TradingBot - INFO - 本地找到文件 data/pos20250529_v3.csv，哈希值: f15f859a3ed30157e3a3be2755a85d1b，未处理，直接使用
2025-05-29 15:57:30,884 - TradingBot - INFO - 处理 20250529 的pos文件，Run_ID:： 2025-05-29_1557:30
2025-05-29 15:57:30,884 - TradingBot - INFO - 🚀 开始执行交易引擎 | Date: 20250529 | RunID: 2025-05-29_1557:30
2025-05-29 15:57:31,039 - TradingBot - INFO - 当前没有未成交的挂单
2025-05-29 15:57:31,042 - TradingBot - INFO - 📋 黑名单过滤结果
├─ 被过滤币种 (7个): BADGERUSDT, BALUSDT, LINAUSDT, NULSUSDT, SNTUSDT, TROYUSDT, VIDTUSDT
└─ 剩余候选池: 166/173
2025-05-29 15:57:31,046 - TradingBot - INFO - 🔍 有效候选列表
├─ 多头候选: 82个
└─ 空头候选: 84个
2025-05-29 15:57:31,347 - TradingBot - INFO - =====账户信息获取成功: totalMarginBalance = 48.08483919, available_balance = 6.07186455=====
2025-05-29 15:57:31,349 - TradingBot - INFO - 每笔交易资金份额: per_share=3.0774885135714283
2025-05-29 15:57:31,487 - TradingBot - INFO - 获取到 14 个非零持仓
2025-05-29 15:57:31,487 - TradingBot - INFO - 当前持仓: {'TRXUSDT': 34.0, 'PROMUSDT': 1.7, 'CRVUSDT': -11.6, 'FLMUSDT': -195.0, 'OMUSDT': -23.5, 'MKRUSDT': 0.005, 'DOGEUSDT': 41.0, 'DASHUSDT': -0.368, 'KAVAUSDT': 21.8, 'IOSTUSDT': 2381.0, 'AERGOUSDT': -60.0, 'XRPUSDT': 4.0, 'DFUSDT': -177.0, 'CAKEUSDT': -3.0}, 是否第一天: False
2025-05-29 15:57:31,676 - TradingBot - INFO - 交易所信息获取成功
2025-05-29 15:57:32,330 - TradingBot - WARNING - BTCUSDT 数量调整为 0 (原值: 0 小于最小值: 0.001)
2025-05-29 15:57:32,331 - TradingBot - WARNING - BTCUSDT 数量调整为 0 (因名义价值 0.0 小于最小值 100.0)
2025-05-29 15:57:32,331 - TradingBot - INFO - BTCUSDT 数量调整: 8.565472219019255e-05 -> 0, 最小值: 0.001, 最大值: 1000.0, 名义价值=0.0, 真实保证金=0.000000, 数量精度=3
2025-05-29 15:57:32,332 - TradingBot - WARNING - BTCUSDT 数量调整为 0，跳过
2025-05-29 15:57:32,872 - TradingBot - INFO - MKRUSDT 数量调整: 0.0052747903449204625 -> 0.005, 最小值: 0.001, 最大值: 10000.0, 名义价值=8.7515, 真实保证金=2.917167, 数量精度=3
2025-05-29 15:57:32,873 - TradingBot - INFO - 添加多头目标: MKRUSDT, 数量=0.005
2025-05-29 15:57:33,379 - TradingBot - INFO - DOGEUSDT 数量调整: 41.19245768399717 -> 41.0, 最小值: 1.0, 最大值: 50000000.0, 名义价值=9.18933, 真实保证金=3.063110, 数量精度=0
2025-05-29 15:57:33,381 - TradingBot - INFO - 添加多头目标: DOGEUSDT, 数量=41.0
2025-05-29 15:57:33,901 - TradingBot - INFO - KAVAUSDT 数量调整: 21.83648424956075 -> 21.8, 最小值: 0.1, 最大值: 1000000.0, 名义价值=9.21704, 真实保证金=3.072347, 数量精度=1
2025-05-29 15:57:33,902 - TradingBot - INFO - 添加多头目标: KAVAUSDT, 数量=21.8
2025-05-29 15:57:33,902 - TradingBot - WARNING - 交易对 KEYUSDT 不可交易，跳过
2025-05-29 15:57:33,902 - TradingBot - WARNING - 交易对 STPTUSDT 不可交易，跳过
2025-05-29 15:57:33,902 - TradingBot - WARNING - 交易对 AMBUSDT 不可交易，跳过
2025-05-29 15:57:33,902 - TradingBot - WARNING - 交易对 REEFUSDT 不可交易，跳过
2025-05-29 15:57:33,902 - TradingBot - WARNING - 交易对 SCUSDT 不可交易，跳过
2025-05-29 15:57:34,459 - TradingBot - INFO - TRXUSDT 数量调整: 33.44005773738377 -> 33.0, 最小值: 1.0, 最大值: 10000000.0, 名义价值=9.11097, 真实保证金=3.036990, 数量精度=0
2025-05-29 15:57:34,460 - TradingBot - INFO - 添加多头目标: TRXUSDT, 数量=33.0
2025-05-29 15:57:34,460 - TradingBot - WARNING - 交易对 SLPUSDT 不可交易，跳过
2025-05-29 15:57:34,460 - TradingBot - WARNING - 交易对 DGBUSDT 不可交易，跳过
2025-05-29 15:57:34,460 - TradingBot - WARNING - 交易对 MDTUSDT 不可交易，跳过
2025-05-29 15:57:34,460 - TradingBot - WARNING - 交易对 RENUSDT 不可交易，跳过
2025-05-29 15:57:34,983 - TradingBot - INFO - IOSTUSDT 数量调整: 2388.7362330437995 -> 2389.0, 最小值: 1.0, 最大值: 80000000.0, 名义价值=9.233485, 真实保证金=3.077828, 数量精度=0
2025-05-29 15:57:34,983 - TradingBot - INFO - 添加多头目标: IOSTUSDT, 数量=2389.0
2025-05-29 15:57:35,577 - TradingBot - INFO - PROMUSDT 数量调整: 1.7231178687410014 -> 1.7, 最小值: 0.1, 最大值: 100000.0, 名义价值=9.1086, 真实保证金=3.036200, 数量精度=1
2025-05-29 15:57:35,577 - TradingBot - INFO - 添加多头目标: PROMUSDT, 数量=1.7
2025-05-29 15:57:36,072 - TradingBot - INFO - XRPUSDT 数量调整: 4.054127932514067 -> 4.1, 最小值: 0.1, 最大值: 10000000.0, 名义价值=9.336929999999999, 真实保证金=3.112310, 数量精度=1
2025-05-29 15:57:36,073 - TradingBot - INFO - 添加多头目标: XRPUSDT, 数量=4.1
2025-05-29 15:57:36,604 - TradingBot - INFO - AERGOUSDT 数量调整: 63.45773277004801 -> 63.0, 最小值: 1.0, 最大值: 4000000.0, 名义价值=9.16587, 真实保证金=3.055290, 数量精度=0
2025-05-29 15:57:36,605 - TradingBot - INFO - 添加空头目标: AERGOUSDT, 数量=-63.0
2025-05-29 15:57:37,223 - TradingBot - INFO - FLMUSDT 数量调整: 193.14781465929465 -> 193.0, 最小值: 1.0, 最大值: 15000000.0, 名义价值=9.2254, 真实保证金=3.075133, 数量精度=0
2025-05-29 15:57:37,223 - TradingBot - INFO - 添加空头目标: FLMUSDT, 数量=-193.0
2025-05-29 15:57:37,772 - TradingBot - INFO - OMUSDT 数量调整: 23.61425567361763 -> 23.6, 最小值: 0.1, 最大值: 10000000.0, 名义价值=9.226892, 真实保证金=3.075631, 数量精度=1
2025-05-29 15:57:37,773 - TradingBot - INFO - 添加空头目标: OMUSDT, 数量=-23.6
2025-05-29 15:57:38,312 - TradingBot - INFO - DASHUSDT 数量调整: 0.38906302320751307 -> 0.389, 最小值: 0.001, 最大值: 10000.0, 名义价值=9.230970000000001, 真实保证金=3.076990, 数量精度=3
2025-05-29 15:57:38,313 - TradingBot - INFO - 添加空头目标: DASHUSDT, 数量=-0.389
2025-05-29 15:57:38,843 - TradingBot - INFO - CRVUSDT 数量调整: 11.79114373015873 -> 11.8, 最小值: 0.1, 最大值: 1000000.0, 名义价值=9.239400000000002, 真实保证金=3.079800, 数量精度=1
2025-05-29 15:57:38,844 - TradingBot - INFO - 添加空头目标: CRVUSDT, 数量=-11.8
2025-05-29 15:57:39,459 - TradingBot - INFO - CAKEUSDT 数量调整: 3.3904247147421267 -> 3.0, 最小值: 1.0, 最大值: 1000000.0, 名义价值=8.1693, 真实保证金=2.723100, 数量精度=0
2025-05-29 15:57:39,460 - TradingBot - INFO - 添加空头目标: CAKEUSDT, 数量=-3.0
2025-05-29 15:57:40,012 - TradingBot - WARNING - BCHUSDT 数量调整为 0 (因名义价值 9.2906 小于最小值 20.0)
2025-05-29 15:57:40,013 - TradingBot - INFO - BCHUSDT 数量调整: 0.021862338481445146 -> 0, 最小值: 0.001, 最大值: 10000.0, 名义价值=0.0, 真实保证金=0.000000, 数量精度=3
2025-05-29 15:57:40,013 - TradingBot - WARNING - BCHUSDT 数量调整为 0，跳过
2025-05-29 15:57:40,597 - TradingBot - INFO - DFUSDT 数量调整: 184.7971485331122 -> 185.0, 最小值: 1.0, 最大值: 5000000.0, 名义价值=9.2426, 真实保证金=3.080867, 数量精度=0
2025-05-29 15:57:40,598 - TradingBot - INFO - 添加空头目标: DFUSDT, 数量=-185.0
2025-05-29 15:57:40,598 - TradingBot - INFO - 初始化目标持仓: {'MKRUSDT': 0.005, 'DOGEUSDT': 41.0, 'KAVAUSDT': 21.8, 'TRXUSDT': 33.0, 'IOSTUSDT': 2389.0, 'PROMUSDT': 1.7, 'XRPUSDT': 4.1, 'AERGOUSDT': -63.0, 'FLMUSDT': -193.0, 'OMUSDT': -23.6, 'DASHUSDT': -0.389, 'CRVUSDT': -11.8, 'CAKEUSDT': -3.0, 'DFUSDT': -185.0}
2025-05-29 15:57:40,751 - TradingBot - INFO - 获取到 14 个非零持仓
2025-05-29 15:57:40,752 - TradingBot - INFO - ==================== 开始持续限价单调仓 ====================
2025-05-29 15:57:40,752 - TradingBot - INFO - 开始第 1 轮调仓...
2025-05-29 15:57:40,905 - TradingBot - INFO - 第 1 轮开始时可用余额: 6.04964239
2025-05-29 15:57:41,095 - TradingBot - INFO - 第 1 轮: 处理平仓 FLMUSDT BUY, 需求数量=2.0
2025-05-29 15:57:41,614 - TradingBot - INFO - FLMUSDT 平仓数量调整: 2.0 -> 2.0, 最小值: 1.0, 最大值: 15000000.0, 名义价值=0.0954, 真实保证金=0.031800, 数量精度=0
2025-05-29 15:57:41,614 - TradingBot - INFO - 第 1 轮: FLMUSDT 平仓调整后数量=2.0
2025-05-29 15:57:41,614 - TradingBot - INFO - 第 1 轮: FLMUSDT 为平仓操作，跳过余额检查
2025-05-29 15:57:41,759 - TradingBot - INFO - 第 1 轮: 准备平仓挂单 FLMUSDT BUY, 数量=2.0, 价格=0.0477, is_close=True
2025-05-29 15:57:41,905 - TradingBot - INFO - FLMUSDT 杠杆设置为 3
2025-05-29 15:57:41,905 - TradingBot - INFO - FLMUSDT 杠杆已设置为 3, is_close=True
2025-05-29 15:57:42,077 - TradingBot - INFO - FLMUSDT 为平仓订单 (reduceOnly=True)，跳过保证金检查
2025-05-29 15:57:42,196 - TradingBot - INFO - FLMUSDT postonly 挂单成功: 方向=BUY, 数量=2.0, 价格=0.0477, 订单ID=8392544502, is_close=True, reduceOnly=True
2025-05-29 15:57:42,343 - TradingBot - INFO - 第 1 轮: FLMUSDT 平仓挂单结果 success=True, order_id=8392544502, order={'orderId': 8392544502, 'symbol': 'FLMUSDT', 'status': 'NEW', 'clientOrderId': 'x-Cb7ytekJ71ca169f7c443e4005ea67', 'price': '0.0477', 'avgPrice': '0.00', 'origQty': '2', 'executedQty': '0', 'cumQty': '0', 'cumQuote': '0.0000', 'timeInForce': 'GTX', 'type': 'LIMIT', 'reduceOnly': True, 'closePosition': False, 'side': 'BUY', 'positionSide': 'BOTH', 'stopPrice': '0.0000', 'workingType': 'CONTRACT_PRICE', 'priceProtect': False, 'origType': 'LIMIT', 'priceMatch': 'NONE', 'selfTradePreventionMode': 'EXPIRE_MAKER', 'goodTillDate': 0, 'updateTime': 1748505462156}
2025-05-29 15:57:42,343 - TradingBot - INFO - 第 1 轮: FLMUSDT BUY postOnly 平仓挂单成功，订单ID=8392544502, is_close=True
2025-05-29 15:57:42,343 - TradingBot - INFO - 第 1 轮: 处理平仓 TRXUSDT SELL, 需求数量=1.0
2025-05-29 15:57:42,826 - TradingBot - INFO - TRXUSDT 平仓数量调整: 1.0 -> 1.0, 最小值: 1.0, 最大值: 10000000.0, 名义价值=0.2761, 真实保证金=0.092033, 数量精度=0
2025-05-29 15:57:42,826 - TradingBot - INFO - 第 1 轮: TRXUSDT 平仓调整后数量=1.0
2025-05-29 15:57:42,826 - TradingBot - INFO - 第 1 轮: TRXUSDT 为平仓操作，跳过余额检查
2025-05-29 15:57:42,970 - TradingBot - INFO - 第 1 轮: 准备平仓挂单 TRXUSDT SELL, 数量=1.0, 价格=0.2761, is_close=True
2025-05-29 15:57:43,109 - TradingBot - INFO - TRXUSDT 杠杆设置为 3
2025-05-29 15:57:43,109 - TradingBot - INFO - TRXUSDT 杠杆已设置为 3, is_close=True
2025-05-29 15:57:43,281 - TradingBot - INFO - TRXUSDT 为平仓订单 (reduceOnly=True)，跳过保证金检查
2025-05-29 15:57:43,429 - TradingBot - INFO - TRXUSDT postonly 挂单成功: 方向=SELL, 数量=1.0, 价格=0.2761, 订单ID=15065519567, is_close=True, reduceOnly=True
2025-05-29 15:57:43,581 - TradingBot - INFO - 第 1 轮: TRXUSDT 平仓挂单结果 success=True, order_id=15065519567, order={'orderId': 15065519567, 'symbol': 'TRXUSDT', 'status': 'NEW', 'clientOrderId': 'x-Cb7ytekJ8444a032aa6fa6d0b48832', 'price': '0.27610', 'avgPrice': '0.00', 'origQty': '1', 'executedQty': '0', 'cumQty': '0', 'cumQuote': '0.00000', 'timeInForce': 'GTX', 'type': 'LIMIT', 'reduceOnly': True, 'closePosition': False, 'side': 'SELL', 'positionSide': 'BOTH', 'stopPrice': '0.00000', 'workingType': 'CONTRACT_PRICE', 'priceProtect': False, 'origType': 'LIMIT', 'priceMatch': 'NONE', 'selfTradePreventionMode': 'EXPIRE_MAKER', 'goodTillDate': 0, 'updateTime': 1748505463365}
2025-05-29 15:57:43,581 - TradingBot - INFO - 第 1 轮: TRXUSDT SELL postOnly 平仓挂单成功，订单ID=15065519567, is_close=True
2025-05-29 15:57:43,581 - TradingBot - INFO - 第 1 轮开仓前可用余额: 6.04964239, 开仓需求: {'FLMUSDT': 0.0, 'DASHUSDT': -0.02100000000000002, 'XRPUSDT': 0.09999999999999964, 'TRXUSDT': 0.0, 'OMUSDT': -0.10000000000000142, 'DFUSDT': -8.0, 'IOSTUSDT': 8.0, 'CRVUSDT': -0.20000000000000107, 'AERGOUSDT': -3.0}
2025-05-29 15:57:43,582 - TradingBot - INFO - 第 1 轮: 跳过 FLMUSDT 开仓，原因：数量为0或已处理
2025-05-29 15:57:43,582 - TradingBot - INFO - 第 1 轮: 处理开仓 DASHUSDT SELL, 需求数量=-0.02100000000000002
2025-05-29 15:57:44,070 - TradingBot - WARNING - DASHUSDT 数量调整为 0 (因名义价值 0.49833000000000005 小于最小值 5.0)
2025-05-29 15:57:44,070 - TradingBot - INFO - DASHUSDT 数量调整: 0.02100000000000002 -> 0, 最小值: 0.001, 最大值: 10000.0, 名义价值=0.0, 真实保证金=0.000000, 数量精度=3
2025-05-29 15:57:44,071 - TradingBot - INFO - 第 1 轮: DASHUSDT 开仓调整后数量=0, is_reverse_open=False
2025-05-29 15:57:44,071 - TradingBot - WARNING - 第 1 轮: DASHUSDT 调整数量为 0，跳过
2025-05-29 15:57:44,071 - TradingBot - INFO - 第 1 轮: 处理开仓 XRPUSDT BUY, 需求数量=0.09999999999999964
2025-05-29 15:57:44,559 - TradingBot - WARNING - XRPUSDT 数量调整为 0 (因名义价值 0.22769 小于最小值 5.0)
2025-05-29 15:57:44,559 - TradingBot - INFO - XRPUSDT 数量调整: 0.09999999999999964 -> 0, 最小值: 0.1, 最大值: 10000000.0, 名义价值=0.0, 真实保证金=0.000000, 数量精度=1
2025-05-29 15:57:44,560 - TradingBot - INFO - 第 1 轮: XRPUSDT 开仓调整后数量=0, is_reverse_open=False
2025-05-29 15:57:44,560 - TradingBot - WARNING - 第 1 轮: XRPUSDT 调整数量为 0，跳过
2025-05-29 15:57:44,560 - TradingBot - INFO - 第 1 轮: 跳过 TRXUSDT 开仓，原因：数量为0或已处理
2025-05-29 15:57:44,560 - TradingBot - INFO - 第 1 轮: 处理开仓 OMUSDT SELL, 需求数量=-0.10000000000000142
2025-05-29 15:57:45,069 - TradingBot - WARNING - OMUSDT 数量调整为 0 (因名义价值 0.03909700000000001 小于最小值 5.0)
2025-05-29 15:57:45,069 - TradingBot - INFO - OMUSDT 数量调整: 0.10000000000000142 -> 0, 最小值: 0.1, 最大值: 10000000.0, 名义价值=0.0, 真实保证金=0.000000, 数量精度=1
2025-05-29 15:57:45,070 - TradingBot - INFO - 第 1 轮: OMUSDT 开仓调整后数量=0, is_reverse_open=False
2025-05-29 15:57:45,070 - TradingBot - WARNING - 第 1 轮: OMUSDT 调整数量为 0，跳过
2025-05-29 15:57:45,070 - TradingBot - INFO - 第 1 轮: 处理开仓 DFUSDT SELL, 需求数量=-8.0
2025-05-29 15:57:45,567 - TradingBot - WARNING - DFUSDT 数量调整为 0 (因名义价值 0.39968000000000004 小于最小值 5.0)
2025-05-29 15:57:45,568 - TradingBot - INFO - DFUSDT 数量调整: 8.0 -> 0, 最小值: 1.0, 最大值: 5000000.0, 名义价值=0.0, 真实保证金=0.000000, 数量精度=0
2025-05-29 15:57:45,569 - TradingBot - INFO - 第 1 轮: DFUSDT 开仓调整后数量=0, is_reverse_open=False
2025-05-29 15:57:45,569 - TradingBot - WARNING - 第 1 轮: DFUSDT 调整数量为 0，跳过
2025-05-29 15:57:45,569 - TradingBot - INFO - 第 1 轮: 处理开仓 IOSTUSDT BUY, 需求数量=8.0
2025-05-29 15:57:46,082 - TradingBot - WARNING - IOSTUSDT 数量调整为 0 (因名义价值 0.030912 小于最小值 5.0)
2025-05-29 15:57:46,082 - TradingBot - INFO - IOSTUSDT 数量调整: 8.0 -> 0, 最小值: 1.0, 最大值: 80000000.0, 名义价值=0.0, 真实保证金=0.000000, 数量精度=0
2025-05-29 15:57:46,083 - TradingBot - INFO - 第 1 轮: IOSTUSDT 开仓调整后数量=0, is_reverse_open=False
2025-05-29 15:57:46,083 - TradingBot - WARNING - 第 1 轮: IOSTUSDT 调整数量为 0，跳过
2025-05-29 15:57:46,084 - TradingBot - INFO - 第 1 轮: 处理开仓 CRVUSDT SELL, 需求数量=-0.20000000000000107
2025-05-29 15:57:46,625 - TradingBot - WARNING - CRVUSDT 数量调整为 0 (因名义价值 0.15660000000000002 小于最小值 5.0)
2025-05-29 15:57:46,625 - TradingBot - INFO - CRVUSDT 数量调整: 0.20000000000000107 -> 0, 最小值: 0.1, 最大值: 1000000.0, 名义价值=0.0, 真实保证金=0.000000, 数量精度=1
2025-05-29 15:57:46,626 - TradingBot - INFO - 第 1 轮: CRVUSDT 开仓调整后数量=0, is_reverse_open=False
2025-05-29 15:57:46,626 - TradingBot - WARNING - 第 1 轮: CRVUSDT 调整数量为 0，跳过
2025-05-29 15:57:46,626 - TradingBot - INFO - 第 1 轮: 处理开仓 AERGOUSDT SELL, 需求数量=-3.0
2025-05-29 15:57:47,185 - TradingBot - WARNING - AERGOUSDT 数量调整为 0 (因名义价值 0.43656000000000006 小于最小值 5.0)
2025-05-29 15:57:47,185 - TradingBot - INFO - AERGOUSDT 数量调整: 3.0 -> 0, 最小值: 1.0, 最大值: 4000000.0, 名义价值=0.0, 真实保证金=0.000000, 数量精度=0
2025-05-29 15:57:47,185 - TradingBot - INFO - 第 1 轮: AERGOUSDT 开仓调整后数量=0, is_reverse_open=False
2025-05-29 15:57:47,185 - TradingBot - WARNING - 第 1 轮: AERGOUSDT 调整数量为 0，跳过
2025-05-29 15:57:47,185 - TradingBot - INFO - 第 1 轮挂单等待，最多 30 秒...
2025-05-29 15:57:49,913 - TradingBot - INFO - 第 1 轮: TRXUSDT SELL 单已成交，订单ID=15065519567, 成交数量=1.0, 均价=0.2761
2025-05-29 15:57:49,913 - TradingBot - INFO - 第 1 轮: TRXUSDT SELL 已完全成交，订单ID=15065519567, 成交数量=1.0
2025-05-29 15:58:17,834 - TradingBot - INFO - 第 1 轮结束，取消所有未成交挂单...
2025-05-29 15:58:17,963 - TradingBot - INFO - 第 1 轮: 发现 1 个未成交订单
2025-05-29 15:58:18,084 - TradingBot - INFO - 成功取消 FLMUSDT 订单，订单ID=8392544502
2025-05-29 15:58:18,084 - TradingBot - INFO - 第 1 轮: 成功取消 FLMUSDT BUY 挂单，订单ID=8392544502
2025-05-29 15:58:18,224 - TradingBot - INFO - 获取到 14 个非零持仓
2025-05-29 15:58:18,739 - TradingBot - INFO - FLMUSDT 平仓数量调整: 2.0 -> 2.0, 最小值: 1.0, 最大值: 15000000.0, 名义价值=0.0956, 真实保证金=0.031867, 数量精度=0
2025-05-29 15:58:18,739 - TradingBot - INFO - 第 1 轮: FLMUSDT 差值 2.0 为小额调整（名义价值 0.0956 < 5 或数量过小），跳过后续轮次
2025-05-29 15:58:19,230 - TradingBot - INFO - DASHUSDT 平仓数量调整: 0.02100000000000002 -> 0.021, 最小值: 0.001, 最大值: 10000.0, 名义价值=0.49812, 真实保证金=0.166040, 数量精度=3
2025-05-29 15:58:19,230 - TradingBot - INFO - 第 1 轮: DASHUSDT 差值 -0.02100000000000002 为小额调整（名义价值 0.49812 < 5 或数量过小），跳过后续轮次
2025-05-29 15:58:19,803 - TradingBot - INFO - XRPUSDT 平仓数量调整: 0.09999999999999964 -> 0.1, 最小值: 0.1, 最大值: 10000000.0, 名义价值=0.22780999999999998, 真实保证金=0.075937, 数量精度=1
2025-05-29 15:58:19,804 - TradingBot - INFO - 第 1 轮: XRPUSDT 差值 0.09999999999999964 为小额调整（名义价值 0.22780999999999998 < 5 或数量过小），跳过后续轮次
2025-05-29 15:58:20,305 - TradingBot - INFO - OMUSDT 平仓数量调整: 0.10000000000000142 -> 0.1, 最小值: 0.1, 最大值: 10000000.0, 名义价值=0.039123000000000005, 真实保证金=0.013041, 数量精度=1
2025-05-29 15:58:20,306 - TradingBot - INFO - 第 1 轮: OMUSDT 差值 -0.10000000000000142 为小额调整（名义价值 0.039123000000000005 < 5 或数量过小），跳过后续轮次
2025-05-29 15:58:20,840 - TradingBot - INFO - DFUSDT 平仓数量调整: 8.0 -> 8.0, 最小值: 1.0, 最大值: 5000000.0, 名义价值=0.39976, 真实保证金=0.133253, 数量精度=0
2025-05-29 15:58:20,841 - TradingBot - INFO - 第 1 轮: DFUSDT 差值 -8.0 为小额调整（名义价值 0.39976 < 5 或数量过小），跳过后续轮次
2025-05-29 15:58:21,377 - TradingBot - INFO - IOSTUSDT 平仓数量调整: 8.0 -> 8.0, 最小值: 1.0, 最大值: 80000000.0, 名义价值=0.030928, 真实保证金=0.010309, 数量精度=0
2025-05-29 15:58:21,378 - TradingBot - INFO - 第 1 轮: IOSTUSDT 差值 8.0 为小额调整（名义价值 0.030928 < 5 或数量过小），跳过后续轮次
2025-05-29 15:58:21,901 - TradingBot - INFO - CRVUSDT 平仓数量调整: 0.20000000000000107 -> 0.2, 最小值: 0.1, 最大值: 1000000.0, 名义价值=0.15660000000000002, 真实保证金=0.052200, 数量精度=1
2025-05-29 15:58:21,901 - TradingBot - INFO - 第 1 轮: CRVUSDT 差值 -0.20000000000000107 为小额调整（名义价值 0.15660000000000002 < 5 或数量过小），跳过后续轮次
2025-05-29 15:58:22,388 - TradingBot - INFO - AERGOUSDT 平仓数量调整: 3.0 -> 3.0, 最小值: 1.0, 最大值: 4000000.0, 名义价值=0.43640999999999996, 真实保证金=0.145470, 数量精度=0
2025-05-29 15:58:22,388 - TradingBot - INFO - 第 1 轮: AERGOUSDT 差值 -3.0 为小额调整（名义价值 0.43640999999999996 < 5 或数量过小），跳过后续轮次
2025-05-29 15:58:22,388 - TradingBot - INFO - 第 1 轮完成，剩余需求: {}
2025-05-29 15:58:22,388 - TradingBot - INFO - 第 1 轮后所有目标已达成，结束限价单调仓
2025-05-29 15:58:22,388 - TradingBot - INFO - ==================== 市价单补齐：后续调仓 ====================
2025-05-29 15:58:22,525 - TradingBot - INFO - 获取到 14 个非零持仓
2025-05-29 15:58:22,525 - TradingBot - INFO - 市价单补齐：所有目标已达成，无需补齐
2025-05-29 15:58:54,315 - TradingBot - INFO - 账户信息已保存为JSON文件: data/account_info_20250529_155854.json
2025-05-29 15:58:54,318 - TradingBot - INFO - account_metrics.xlsx 为空或不存在，回报率设为 0
2025-05-29 15:58:54,898 - TradingBot - INFO - 成功写入 14 条指标到 data/account_metrics.xlsx，Run_ID=2025-05-29_1557:30
2025-05-29 15:58:54,898 - TradingBot - INFO - ✅ 交易引擎执行完成 | RunID: 2025-05-29_1557:30
2025-05-29 15:58:54,898 - TradingBot - INFO - 当前日期: 2025-05-29, Run_ID: 2025-05-29_1557:30
2025-05-29 15:58:54,900 - TradingBot - INFO - 读取 data/positions_output.csv，去重后包含 123 条记录
2025-05-29 15:58:54,900 - TradingBot - INFO - 找到 0 条 Run_ID=2025-05-29_1557:30 或日期=2025-05-29 的记录
2025-05-29 15:58:54,900 - TradingBot - INFO - 当前 Run_ID 无持仓数据，创建空结果
2025-05-29 15:58:54,901 - TradingBot - INFO - 正持仓数量: 0, 负持仓数量: 0
2025-05-29 15:58:54,902 - TradingBot - INFO - 资金费率文件 data/pos20250529_v3.csv 已加载，去重后包含 173 条记录
2025-05-29 15:58:54,903 - TradingBot - INFO - 已为 7 个黑名单币种设置 ErrorReason: 黑名单过滤
2025-05-29 15:58:54,903 - TradingBot - ERROR - 已筛选出 19 个币种映射错误原因
2025-05-29 15:58:54,904 - TradingBot - INFO - 已为 19 个币种映射其他错误原因
2025-05-29 15:58:54,906 - TradingBot - INFO - 无有效持仓数据，生成空结果
2025-05-29 15:58:54,996 - TradingBot - INFO - 分析结果已去重并追加写入文件: data/position_analysis.xlsx，记录数: 237
2025-05-29 15:58:55,048 - TradingBot - INFO - 唯一日期数量为 8，执行执行交易数据可视化...
2025-05-29 15:58:55,127 - TradingBot - ERROR - 读取 data\account_metrics.xlsx 时出现错误: 'numpy.ndarray' object is not callable
2025-05-29 15:58:55,127 - TradingBot - INFO - 20250529 交易完成，Run_ID: 2025-05-29_1557:30
2025-05-29 15:58:55,127 - TradingBot - INFO - 记录已处理文件 data/pos20250529_v3.csv，哈希值: f15f859a3ed30157e3a3be2755a85d1b，Run_ID: 2025-05-29_1557:30
2025-05-29 15:58:55,127 - TradingBot - INFO - 交易完成后等待 10 分钟分钟
2025-05-29 16:00:09,078 - TradingBot - INFO - 日志初始化成功，当前日志文件: logs\trading_2025-05-29.log
2025-05-29 16:00:09,078 - TradingBot - INFO - 交易程序启动，进入日内多次换仓模式
2025-05-29 16:00:09,436 - TradingBot - INFO - Binance 客户端初始化成功，测试网络: False
2025-05-29 16:00:09,960 - TradingBot - INFO - 所有交易对已是全仓模式 (CROSSED)，无需修改
2025-05-29 16:00:10,119 - TradingBot - INFO - 账户已是单币种模式 (Single)，无需修改
2025-05-29 16:00:10,259 - TradingBot - INFO - 账户已是单向模式 (One-way)，无需修改
2025-05-29 16:00:10,700 - TradingBot - INFO - 检查 20250529 的文件或邮件，Run_ID: 2025-05-29_160010
2025-05-29 16:00:10,701 - TradingBot - INFO - 检查本地文件: data/pos20250529_v3.csv
2025-05-29 16:00:10,701 - TradingBot - INFO - 本地找到文件 data/pos20250529_v3.csv，哈希: f15f859a3ed30157e3a3be2755a85d1b，未处理，直接使用
2025-05-29 16:00:10,701 - TradingBot - INFO - 处理 20250529 的pos文件，Run_ID: 2025-05-29_160010
2025-05-29 16:00:10,701 - TradingBot - INFO - 🚀 开始执行交易引擎 | Date: 20250529 | RunID: 2025-05-29_160010
2025-05-29 16:00:10,848 - TradingBot - INFO - 当前没有未成交的挂单
2025-05-29 16:00:10,851 - TradingBot - INFO - 📋 黑名单过滤结果
├─ 被过滤币种 (7个): BADGERUSDT, BALUSDT, LINAUSDT, NULSUSDT, SNTUSDT, TROYUSDT, VIDTUSDT
└─ 剩余候选池: 166/173
2025-05-29 16:00:10,855 - TradingBot - INFO - 🔍 有效候选列表
├─ 多头候选: 82个
└─ 空头候选: 84个
2025-05-29 16:00:11,161 - TradingBot - INFO - =====账户信息获取成功: totalMarginBalance = 48.05981315, available_balance = 6.11378348=====
2025-05-29 16:00:11,161 - TradingBot - INFO - 每笔交易资金份额: per_share=3.075700939285714
2025-05-29 16:00:11,290 - TradingBot - INFO - 获取到 14 个非零持仓
2025-05-29 16:00:11,290 - TradingBot - INFO - 当前持仓: {'TRXUSDT': 33.0, 'PROMUSDT': 1.7, 'CRVUSDT': -11.6, 'FLMUSDT': -195.0, 'OMUSDT': -23.5, 'MKRUSDT': 0.005, 'DOGEUSDT': 41.0, 'DASHUSDT': -0.368, 'KAVAUSDT': 21.8, 'IOSTUSDT': 2381.0, 'AERGOUSDT': -60.0, 'XRPUSDT': 4.0, 'DFUSDT': -177.0, 'CAKEUSDT': -3.0}, 是否第一天: False
2025-05-29 16:00:11,514 - TradingBot - INFO - 交易所信息获取成功
2025-05-29 16:00:12,167 - TradingBot - WARNING - BTCUSDT 数量调整为 0 (原值: 0 小于最小值: 0.001)
2025-05-29 16:00:12,167 - TradingBot - WARNING - BTCUSDT 数量调整为 0 (因名义价值 0.0 小于最小值 100.0)
2025-05-29 16:00:12,167 - TradingBot - INFO - BTCUSDT 数量调整: 8.555060073762713e-05 -> 0, 最小值: 0.001, 最大值: 1000.0, 名义价值=0.0, 真实保证金=0.000000, 数量精度=3
2025-05-29 16:00:12,168 - TradingBot - WARNING - BTCUSDT 数量调整为 0，跳过
2025-05-29 16:00:12,679 - TradingBot - INFO - MKRUSDT 数量调整: 0.0052696189707922 -> 0.005, 最小值: 0.001, 最大值: 10000.0, 名义价值=8.755, 真实保证金=2.918333, 数量精度=3
2025-05-29 16:00:12,679 - TradingBot - INFO - 添加多头目标: MKRUSDT, 数量=0.005
2025-05-29 16:00:13,188 - TradingBot - INFO - DOGEUSDT 数量调整: 41.12266163587282 -> 41.0, 最小值: 1.0, 最大值: 50000000.0, 名义价值=9.19958, 真实保证金=3.066527, 数量精度=0
2025-05-29 16:00:13,188 - TradingBot - INFO - 添加多头目标: DOGEUSDT, 数量=41.0
2025-05-29 16:00:13,708 - TradingBot - INFO - KAVAUSDT 数量调整: 21.849639634992048 -> 21.8, 最小值: 0.1, 最大值: 1000000.0, 名义价值=9.206140000000001, 真实保证金=3.068713, 数量精度=1
2025-05-29 16:00:13,708 - TradingBot - INFO - 添加多头目标: KAVAUSDT, 数量=21.8
2025-05-29 16:00:13,708 - TradingBot - WARNING - 交易对 KEYUSDT 不可交易，跳过
2025-05-29 16:00:13,708 - TradingBot - WARNING - 交易对 STPTUSDT 不可交易，跳过
2025-05-29 16:00:13,708 - TradingBot - WARNING - 交易对 AMBUSDT 不可交易，跳过
2025-05-29 16:00:13,708 - TradingBot - WARNING - 交易对 REEFUSDT 不可交易，跳过
2025-05-29 16:00:13,708 - TradingBot - WARNING - 交易对 SCUSDT 不可交易，跳过
2025-05-29 16:00:14,201 - TradingBot - INFO - TRXUSDT 数量调整: 33.39885915176147 -> 33.0, 最小值: 1.0, 最大值: 10000000.0, 名义价值=9.11691, 真实保证金=3.038970, 数量精度=0
2025-05-29 16:00:14,202 - TradingBot - INFO - 添加多头目标: TRXUSDT, 数量=33.0
2025-05-29 16:00:14,203 - TradingBot - WARNING - 交易对 SLPUSDT 不可交易，跳过
2025-05-29 16:00:14,203 - TradingBot - WARNING - 交易对 DGBUSDT 不可交易，跳过
2025-05-29 16:00:14,203 - TradingBot - WARNING - 交易对 MDTUSDT 不可交易，跳过
2025-05-29 16:00:14,203 - TradingBot - WARNING - 交易对 RENUSDT 不可交易，跳过
2025-05-29 16:00:14,697 - TradingBot - INFO - IOSTUSDT 数量调整: 2387.9665677684116 -> 2388.0, 最小值: 1.0, 最大值: 80000000.0, 名义价值=9.227231999999999, 真实保证金=3.075744, 数量精度=0
2025-05-29 16:00:14,697 - TradingBot - INFO - 添加多头目标: IOSTUSDT, 数量=2388.0
2025-05-29 16:00:15,170 - TradingBot - INFO - PROMUSDT 数量调整: 1.722438457692205 -> 1.7, 最小值: 0.1, 最大值: 100000.0, 名义价值=9.1069, 真实保证金=3.035633, 数量精度=1
2025-05-29 16:00:15,171 - TradingBot - INFO - 添加多头目标: PROMUSDT, 数量=1.7
2025-05-29 16:00:15,725 - TradingBot - INFO - XRPUSDT 数量调整: 4.048217793996903 -> 4.0, 最小值: 0.1, 最大值: 10000000.0, 名义价值=9.1172, 真实保证金=3.039067, 数量精度=1
2025-05-29 16:00:15,725 - TradingBot - INFO - 添加多头目标: XRPUSDT, 数量=4.0
2025-05-29 16:00:16,211 - TradingBot - INFO - AERGOUSDT 数量调整: 63.50380466522465 -> 64.0, 最小值: 1.0, 最大值: 4000000.0, 名义价值=9.2992, 真实保证金=3.099733, 数量精度=0
2025-05-29 16:00:16,212 - TradingBot - INFO - 添加空头目标: AERGOUSDT, 数量=-64.0
2025-05-29 16:00:16,677 - TradingBot - INFO - FLMUSDT 数量调整: 193.03562380454272 -> 193.0, 最小值: 1.0, 最大值: 15000000.0, 名义价值=9.2254, 真实保证金=3.075133, 数量精度=0
2025-05-29 16:00:16,678 - TradingBot - INFO - 添加空头目标: FLMUSDT, 数量=-193.0
2025-05-29 16:00:17,167 - TradingBot - INFO - OMUSDT 数量调整: 23.60295402720984 -> 23.6, 最小值: 0.1, 最大值: 10000000.0, 名义价值=9.225948, 真实保证金=3.075316, 数量精度=1
2025-05-29 16:00:17,168 - TradingBot - INFO - 添加空头目标: OMUSDT, 数量=-23.6
2025-05-29 16:00:17,645 - TradingBot - INFO - DASHUSDT 数量调整: 0.3890009619669959 -> 0.389, 最小值: 0.001, 最大值: 10000.0, 名义价值=9.227079999999999, 真实保证金=3.075693, 数量精度=3
2025-05-29 16:00:17,646 - TradingBot - INFO - 添加空头目标: DASHUSDT, 数量=-0.389
2025-05-29 16:00:18,155 - TradingBot - INFO - CRVUSDT 数量调整: 11.784294786535304 -> 11.8, 最小值: 0.1, 最大值: 1000000.0, 名义价值=9.239400000000002, 真实保证金=3.079800, 数量精度=1
2025-05-29 16:00:18,156 - TradingBot - INFO - 添加空头目标: CRVUSDT, 数量=-11.8
2025-05-29 16:00:18,628 - TradingBot - INFO - CAKEUSDT 数量调整: 3.3817492460535616 -> 3.0, 最小值: 1.0, 最大值: 1000000.0, 名义价值=8.1855, 真实保证金=2.728500, 数量精度=0
2025-05-29 16:00:18,628 - TradingBot - INFO - 添加空头目标: CAKEUSDT, 数量=-3.0
2025-05-29 16:00:19,107 - TradingBot - WARNING - BCHUSDT 数量调整为 0 (因名义价值 9.3082 小于最小值 20.0)
2025-05-29 16:00:19,107 - TradingBot - INFO - BCHUSDT 数量调整: 0.021808326206232905 -> 0, 最小值: 0.001, 最大值: 10000.0, 名义价值=0.0, 真实保证金=0.000000, 数量精度=3
2025-05-29 16:00:19,108 - TradingBot - WARNING - BCHUSDT 数量调整为 0，跳过
2025-05-29 16:00:19,579 - TradingBot - INFO - DFUSDT 数量调整: 184.72678314028312 -> 185.0, 最小值: 1.0, 最大值: 5000000.0, 名义价值=9.24075, 真实保证金=3.080250, 数量精度=0
2025-05-29 16:00:19,579 - TradingBot - INFO - 添加空头目标: DFUSDT, 数量=-185.0
2025-05-29 16:00:19,579 - TradingBot - INFO - 初始化目标持仓: {'MKRUSDT': 0.005, 'DOGEUSDT': 41.0, 'KAVAUSDT': 21.8, 'TRXUSDT': 33.0, 'IOSTUSDT': 2388.0, 'PROMUSDT': 1.7, 'XRPUSDT': 4.0, 'AERGOUSDT': -64.0, 'FLMUSDT': -193.0, 'OMUSDT': -23.6, 'DASHUSDT': -0.389, 'CRVUSDT': -11.8, 'CAKEUSDT': -3.0, 'DFUSDT': -185.0}
2025-05-29 16:00:19,714 - TradingBot - INFO - 获取到 14 个非零持仓
2025-05-29 16:00:19,715 - TradingBot - INFO - ==================== 开始持续限价单调仓 ====================
2025-05-29 16:00:19,715 - TradingBot - INFO - 开始第 1 轮调仓...
2025-05-29 16:00:19,862 - TradingBot - INFO - 第 1 轮开始时可用余额: 6.10921023
2025-05-29 16:00:20,006 - TradingBot - INFO - 第 1 轮: 处理平仓 FLMUSDT BUY, 需求数量=2.0
2025-05-29 16:00:20,529 - TradingBot - INFO - FLMUSDT 平仓数量调整: 2.0 -> 2.0, 最小值: 1.0, 最大值: 15000000.0, 名义价值=0.0954, 真实保证金=0.031800, 数量精度=0
2025-05-29 16:00:20,529 - TradingBot - INFO - 第 1 轮: FLMUSDT 平仓调整后数量=2.0
2025-05-29 16:00:20,529 - TradingBot - INFO - 第 1 轮: FLMUSDT 为平仓操作，跳过余额检查
2025-05-29 16:00:20,670 - TradingBot - INFO - 第 1 轮: 准备平仓挂单 FLMUSDT BUY, 数量=2.0, 价格=0.0477, is_close=True
2025-05-29 16:00:20,811 - TradingBot - INFO - FLMUSDT 杠杆设置为 3
2025-05-29 16:00:20,811 - TradingBot - INFO - FLMUSDT 杠杆已设置为 3, is_close=True
2025-05-29 16:00:20,980 - TradingBot - INFO - FLMUSDT 为平仓订单 (reduceOnly=True)，跳过保证金检查
2025-05-29 16:00:21,095 - TradingBot - INFO - FLMUSDT postonly 挂单成功: 方向=BUY, 数量=2.0, 价格=0.0477, 订单ID=8392555336, is_close=True, reduceOnly=True
2025-05-29 16:00:21,232 - TradingBot - INFO - 第 1 轮: FLMUSDT 平仓挂单结果 success=True, order_id=8392555336, order={'orderId': 8392555336, 'symbol': 'FLMUSDT', 'status': 'NEW', 'clientOrderId': 'x-Cb7ytekJb85d3634f76c686544fa95', 'price': '0.0477', 'avgPrice': '0.00', 'origQty': '2', 'executedQty': '0', 'cumQty': '0', 'cumQuote': '0.0000', 'timeInForce': 'GTX', 'type': 'LIMIT', 'reduceOnly': True, 'closePosition': False, 'side': 'BUY', 'positionSide': 'BOTH', 'stopPrice': '0.0000', 'workingType': 'CONTRACT_PRICE', 'priceProtect': False, 'origType': 'LIMIT', 'priceMatch': 'NONE', 'selfTradePreventionMode': 'EXPIRE_MAKER', 'goodTillDate': 0, 'updateTime': 1748505621058}
2025-05-29 16:00:21,232 - TradingBot - INFO - 第 1 轮: FLMUSDT BUY postOnly 平仓挂单成功，订单ID=8392555336, is_close=True
2025-05-29 16:00:21,232 - TradingBot - INFO - 第 1 轮开仓前可用余额: 6.10921023, 开仓需求: {'OMUSDT': -0.10000000000000142, 'CRVUSDT': -0.20000000000000107, 'FLMUSDT': 0.0, 'IOSTUSDT': 7.0, 'AERGOUSDT': -4.0, 'DFUSDT': -8.0, 'DASHUSDT': -0.02100000000000002}
2025-05-29 16:00:21,233 - TradingBot - INFO - 第 1 轮: 处理开仓 OMUSDT SELL, 需求数量=-0.10000000000000142
2025-05-29 16:00:21,755 - TradingBot - WARNING - OMUSDT 数量调整为 0 (因名义价值 0.03909900000000001 小于最小值 5.0)
2025-05-29 16:00:21,755 - TradingBot - INFO - OMUSDT 数量调整: 0.10000000000000142 -> 0, 最小值: 0.1, 最大值: 10000000.0, 名义价值=0.0, 真实保证金=0.000000, 数量精度=1
2025-05-29 16:00:21,756 - TradingBot - INFO - 第 1 轮: OMUSDT 开仓调整后数量=0, is_reverse_open=False
2025-05-29 16:00:21,756 - TradingBot - WARNING - 第 1 轮: OMUSDT 调整数量为 0，跳过
2025-05-29 16:00:21,756 - TradingBot - INFO - 第 1 轮: 处理开仓 CRVUSDT SELL, 需求数量=-0.20000000000000107
2025-05-29 16:00:22,215 - TradingBot - WARNING - CRVUSDT 数量调整为 0 (因名义价值 0.15680000000000002 小于最小值 5.0)
2025-05-29 16:00:22,216 - TradingBot - INFO - CRVUSDT 数量调整: 0.20000000000000107 -> 0, 最小值: 0.1, 最大值: 1000000.0, 名义价值=0.0, 真实保证金=0.000000, 数量精度=1
2025-05-29 16:00:22,218 - TradingBot - INFO - 第 1 轮: CRVUSDT 开仓调整后数量=0, is_reverse_open=False
2025-05-29 16:00:22,218 - TradingBot - WARNING - 第 1 轮: CRVUSDT 调整数量为 0，跳过
2025-05-29 16:00:22,218 - TradingBot - INFO - 第 1 轮: 跳过 FLMUSDT 开仓，原因：数量为0或已处理
2025-05-29 16:00:22,218 - TradingBot - INFO - 第 1 轮: 处理开仓 IOSTUSDT BUY, 需求数量=7.0
2025-05-29 16:00:22,694 - TradingBot - WARNING - IOSTUSDT 数量调整为 0 (因名义价值 0.027041 小于最小值 5.0)
2025-05-29 16:00:22,694 - TradingBot - INFO - IOSTUSDT 数量调整: 7.0 -> 0, 最小值: 1.0, 最大值: 80000000.0, 名义价值=0.0, 真实保证金=0.000000, 数量精度=0
2025-05-29 16:00:22,695 - TradingBot - INFO - 第 1 轮: IOSTUSDT 开仓调整后数量=0, is_reverse_open=False
2025-05-29 16:00:22,695 - TradingBot - WARNING - 第 1 轮: IOSTUSDT 调整数量为 0，跳过
2025-05-29 16:00:22,695 - TradingBot - INFO - 第 1 轮: 处理开仓 AERGOUSDT SELL, 需求数量=-4.0
2025-05-29 16:00:23,161 - TradingBot - WARNING - AERGOUSDT 数量调整为 0 (因名义价值 0.5815600000000001 小于最小值 5.0)
2025-05-29 16:00:23,162 - TradingBot - INFO - AERGOUSDT 数量调整: 4.0 -> 0, 最小值: 1.0, 最大值: 4000000.0, 名义价值=0.0, 真实保证金=0.000000, 数量精度=0
2025-05-29 16:00:23,163 - TradingBot - INFO - 第 1 轮: AERGOUSDT 开仓调整后数量=0, is_reverse_open=False
2025-05-29 16:00:23,163 - TradingBot - WARNING - 第 1 轮: AERGOUSDT 调整数量为 0，跳过
2025-05-29 16:00:23,163 - TradingBot - INFO - 第 1 轮: 处理开仓 DFUSDT SELL, 需求数量=-8.0
2025-05-29 16:00:23,950 - TradingBot - WARNING - DFUSDT 数量调整为 0 (因名义价值 0.3996 小于最小值 5.0)
2025-05-29 16:00:23,950 - TradingBot - INFO - DFUSDT 数量调整: 8.0 -> 0, 最小值: 1.0, 最大值: 5000000.0, 名义价值=0.0, 真实保证金=0.000000, 数量精度=0
2025-05-29 16:00:23,951 - TradingBot - INFO - 第 1 轮: DFUSDT 开仓调整后数量=0, is_reverse_open=False
2025-05-29 16:00:23,951 - TradingBot - WARNING - 第 1 轮: DFUSDT 调整数量为 0，跳过
2025-05-29 16:00:23,951 - TradingBot - INFO - 第 1 轮: 处理开仓 DASHUSDT SELL, 需求数量=-0.02100000000000002
2025-05-29 16:00:24,432 - TradingBot - WARNING - DASHUSDT 数量调整为 0 (因名义价值 0.49833000000000005 小于最小值 5.0)
2025-05-29 16:00:24,432 - TradingBot - INFO - DASHUSDT 数量调整: 0.02100000000000002 -> 0, 最小值: 0.001, 最大值: 10000.0, 名义价值=0.0, 真实保证金=0.000000, 数量精度=3
2025-05-29 16:00:24,433 - TradingBot - INFO - 第 1 轮: DASHUSDT 开仓调整后数量=0, is_reverse_open=False
2025-05-29 16:00:24,433 - TradingBot - WARNING - 第 1 轮: DASHUSDT 调整数量为 0，跳过
2025-05-29 16:00:24,433 - TradingBot - INFO - 第 1 轮挂单等待，最多 30 秒...
2025-05-29 16:00:56,536 - TradingBot - INFO - 第 1 轮结束，取消所有未成交挂单...
2025-05-29 16:00:56,684 - TradingBot - INFO - 第 1 轮: 发现 1 个未成交订单
2025-05-29 16:00:56,801 - TradingBot - INFO - 成功取消 FLMUSDT 订单，订单ID=8392555336
2025-05-29 16:00:56,801 - TradingBot - INFO - 第 1 轮: 成功取消 FLMUSDT BUY 挂单，订单ID=8392555336
2025-05-29 16:00:56,950 - TradingBot - INFO - 获取到 14 个非零持仓
2025-05-29 16:00:57,443 - TradingBot - INFO - OMUSDT 平仓数量调整: 0.10000000000000142 -> 0.1, 最小值: 0.1, 最大值: 10000000.0, 名义价值=0.039105, 真实保证金=0.013035, 数量精度=1
2025-05-29 16:00:57,444 - TradingBot - INFO - 第 1 轮: OMUSDT 差值 -0.10000000000000142 为小额调整（名义价值 0.039105 < 5 或数量过小），跳过后续轮次
2025-05-29 16:00:57,884 - TradingBot - INFO - CRVUSDT 平仓数量调整: 0.20000000000000107 -> 0.2, 最小值: 0.1, 最大值: 1000000.0, 名义价值=0.1564, 真实保证金=0.052133, 数量精度=1
2025-05-29 16:00:57,889 - TradingBot - INFO - 第 1 轮: CRVUSDT 差值 -0.20000000000000107 为小额调整（名义价值 0.1564 < 5 或数量过小），跳过后续轮次
2025-05-29 16:00:58,462 - TradingBot - INFO - FLMUSDT 平仓数量调整: 2.0 -> 2.0, 最小值: 1.0, 最大值: 15000000.0, 名义价值=0.0956, 真实保证金=0.031867, 数量精度=0
2025-05-29 16:00:58,462 - TradingBot - INFO - 第 1 轮: FLMUSDT 差值 2.0 为小额调整（名义价值 0.0956 < 5 或数量过小），跳过后续轮次
2025-05-29 16:00:58,907 - TradingBot - INFO - IOSTUSDT 平仓数量调整: 7.0 -> 7.0, 最小值: 1.0, 最大值: 80000000.0, 名义价值=0.027048, 真实保证金=0.009016, 数量精度=0
2025-05-29 16:00:58,908 - TradingBot - INFO - 第 1 轮: IOSTUSDT 差值 7.0 为小额调整（名义价值 0.027048 < 5 或数量过小），跳过后续轮次
2025-05-29 16:00:59,368 - TradingBot - INFO - AERGOUSDT 平仓数量调整: 4.0 -> 4.0, 最小值: 1.0, 最大值: 4000000.0, 名义价值=0.58188, 真实保证金=0.193960, 数量精度=0
2025-05-29 16:00:59,368 - TradingBot - INFO - 第 1 轮: AERGOUSDT 差值 -4.0 为小额调整（名义价值 0.58188 < 5 或数量过小），跳过后续轮次
2025-05-29 16:00:59,841 - TradingBot - INFO - DFUSDT 平仓数量调整: 8.0 -> 8.0, 最小值: 1.0, 最大值: 5000000.0, 名义价值=0.39928, 真实保证金=0.133093, 数量精度=0
2025-05-29 16:00:59,842 - TradingBot - INFO - 第 1 轮: DFUSDT 差值 -8.0 为小额调整（名义价值 0.39928 < 5 或数量过小），跳过后续轮次
2025-05-29 16:01:00,298 - TradingBot - INFO - DASHUSDT 平仓数量调整: 0.02100000000000002 -> 0.021, 最小值: 0.001, 最大值: 10000.0, 名义价值=0.49812, 真实保证金=0.166040, 数量精度=3
2025-05-29 16:01:00,298 - TradingBot - INFO - 第 1 轮: DASHUSDT 差值 -0.02100000000000002 为小额调整（名义价值 0.49812 < 5 或数量过小），跳过后续轮次
2025-05-29 16:01:00,298 - TradingBot - INFO - 第 1 轮完成，剩余需求: {}
2025-05-29 16:01:00,298 - TradingBot - INFO - 第 1 轮后所有目标已达成，结束限价单调仓
2025-05-29 16:01:00,298 - TradingBot - INFO - ==================== 市价单补齐：后续调仓 ====================
2025-05-29 16:01:00,436 - TradingBot - INFO - 获取到 14 个非零持仓
2025-05-29 16:01:00,436 - TradingBot - INFO - 市价单补齐：所有目标已达成，无需补齐
2025-05-29 16:01:26,574 - TradingBot - INFO - 账户信息已保存为JSON文件: data/account_info_20250529_160126.json
2025-05-29 16:01:26,576 - TradingBot - INFO - account_metrics.xlsx 为空或不存在，回报率设为 0
2025-05-29 16:01:27,107 - TradingBot - INFO - 成功写入 14 条指标到 data/account_metrics.xlsx，Run_ID=2025-05-29_160010
2025-05-29 16:01:27,107 - TradingBot - INFO - ✅ 交易引擎执行完成 | RunID: 2025-05-29_160010
2025-05-29 16:01:27,107 - TradingBot - INFO - 当前日期: 2025-05-29, Run_ID: 2025-05-29_160010
2025-05-29 16:01:27,109 - TradingBot - INFO - 读取 data/positions_output.csv，去重后包含 123 条记录
2025-05-29 16:01:27,110 - TradingBot - INFO - 找到 0 条 Run_ID=2025-05-29_160010 或日期=2025-05-29 的记录
2025-05-29 16:01:27,110 - TradingBot - INFO - 当前 Run_ID 无持仓数据，创建空结果
2025-05-29 16:01:27,111 - TradingBot - INFO - 正持仓数量: 0, 负持仓数量: 0
2025-05-29 16:01:27,112 - TradingBot - INFO - 资金费率文件 data/pos20250529_v3.csv 已加载，去重后包含 173 条记录
2025-05-29 16:01:27,113 - TradingBot - INFO - 已为 7 个黑名单币种设置 ErrorReason: 黑名单过滤
2025-05-29 16:01:27,113 - TradingBot - INFO - 已为 18 个币种映射其他错误原因
2025-05-29 16:01:27,116 - TradingBot - INFO - 无有效持仓数据，生成空结果
2025-05-29 16:01:27,193 - TradingBot - INFO - 分析结果已去重并追加写入文件: data/position_analysis.xlsx，记录数: 237
2025-05-29 16:01:27,241 - TradingBot - INFO - 唯一日期数量为 8，执行可视化...
2025-05-29 16:01:27,317 - TradingBot - INFO - 添加附件: data\position_analysis.xlsx
2025-05-29 16:01:27,317 - TradingBot - INFO - 未找到可视化 PDF 文件: data\2025-05-29_account_metrics_data_visualization.pdf
2025-05-29 16:01:27,329 - TradingBot - INFO - 尝试连接到 smtp.gmail.com:465 (第 1/5)
2025-05-29 16:01:28,312 - TradingBot - INFO - 连接成功，开始登录
2025-05-29 16:01:32,598 - TradingBot - INFO - 邮件发送成功！
2025-05-29 16:01:32,816 - TradingBot - INFO - 20250529 交易完成，Run_ID: 2025-05-29_160010
2025-05-29 16:01:32,816 - TradingBot - INFO - 记录已处理文件 data/pos20250529_v3.csv，哈希: f15f859a3ed30157e3a3be2755a85d1b，Run_ID: 2025-05-29_160010
2025-05-29 16:01:32,816 - TradingBot - INFO - 交易完成后等待 10 分钟
2025-05-29 17:36:40,232 - TradingBot - INFO - 日志初始化成功，当前日志文件: logs\trading_2025-05-29.log
2025-05-29 17:36:40,232 - TradingBot - INFO - 交易程序启动，进入日内多次换仓模式
2025-05-29 17:36:40,674 - TradingBot - INFO - Binance 客户端初始化成功，测试网络: False
2025-05-29 17:36:41,239 - TradingBot - INFO - 所有交易对已是全仓模式 (CROSSED)，无需修改
2025-05-29 17:36:41,461 - TradingBot - INFO - 账户已是单币种模式 (Single)，无需修改
2025-05-29 17:36:41,612 - TradingBot - INFO - 账户已是单向模式 (One-way)，无需修改
2025-05-29 17:36:42,098 - TradingBot - INFO - 检查 20250529 的文件或邮件，Run_ID: 2025-05-29_173642
2025-05-29 17:36:42,099 - TradingBot - INFO - 检查本地文件: data/pos20250529_v3.csv
2025-05-29 17:36:42,099 - TradingBot - INFO - 本地找到文件 data/pos20250529_v3.csv，哈希: f15f859a3ed30157e3a3be2755a85d1b，未处理，直接使用
2025-05-29 17:36:42,099 - TradingBot - INFO - 处理 20250529 的pos文件，Run_ID: 2025-05-29_173642
2025-05-29 17:36:42,099 - TradingBot - INFO - 🚀 开始执行交易引擎 | Date: 20250529 | RunID: 2025-05-29_173642
2025-05-29 17:36:42,343 - TradingBot - INFO - 当前没有未成交的挂单
2025-05-29 17:36:42,348 - TradingBot - INFO - 📋 黑名单过滤结果
├─ 被过滤币种 (7个): BADGERUSDT, BALUSDT, LINAUSDT, NULSUSDT, SNTUSDT, TROYUSDT, VIDTUSDT
└─ 剩余候选池: 166/173
2025-05-29 17:36:42,355 - TradingBot - INFO - 🔍 有效候选列表
├─ 多头候选: 82个
└─ 空头候选: 84个
2025-05-29 17:36:42,689 - TradingBot - INFO - =====账户信息获取成功: totalMarginBalance = 47.91525752, available_balance = 5.86791874=====
2025-05-29 17:36:42,689 - TradingBot - INFO - 每笔交易资金份额: per_share=3.065375537142857
2025-05-29 17:36:42,856 - TradingBot - INFO - 获取到 14 个非零持仓
2025-05-29 17:36:42,857 - TradingBot - INFO - 当前持仓: {'TRXUSDT': 33.0, 'PROMUSDT': 1.7, 'CRVUSDT': -11.6, 'FLMUSDT': -195.0, 'OMUSDT': -23.5, 'MKRUSDT': 0.005, 'DOGEUSDT': 41.0, 'DASHUSDT': -0.368, 'KAVAUSDT': 21.8, 'IOSTUSDT': 2381.0, 'AERGOUSDT': -60.0, 'XRPUSDT': 4.0, 'DFUSDT': -177.0, 'CAKEUSDT': -3.0}, 是否第一天: False
2025-05-29 17:36:43,151 - TradingBot - INFO - 交易所信息获取成功
2025-05-29 17:36:43,843 - TradingBot - WARNING - BTCUSDT 数量调整为 0 (原值: 0 小于最小值: 0.001)
2025-05-29 17:36:43,843 - TradingBot - WARNING - BTCUSDT 数量调整为 0 (因名义价值 0.0 小于最小值 100.0)
2025-05-29 17:36:43,843 - TradingBot - INFO - BTCUSDT 数量调整: 8.479803675725349e-05 -> 0, 最小值: 0.001, 最大值: 1000.0, 名义价值=0.0, 真实保证金=0.000000, 数量精度=3
2025-05-29 17:36:43,844 - TradingBot - WARNING - BTCUSDT 数量调整为 0，跳过
2025-05-29 17:36:44,434 - TradingBot - INFO - MKRUSDT 数量调整: 0.005292430140094712 -> 0.005, 最小值: 0.001, 最大值: 10000.0, 名义价值=8.688, 真实保证金=2.896000, 数量精度=3
2025-05-29 17:36:44,435 - TradingBot - INFO - 添加多头目标: MKRUSDT, 数量=0.005
2025-05-29 17:36:44,890 - TradingBot - INFO - DOGEUSDT 数量调整: 40.800952178129336 -> 41.0, 最小值: 1.0, 最大值: 50000000.0, 名义价值=9.24099, 真实保证金=3.080330, 数量精度=0
2025-05-29 17:36:44,891 - TradingBot - INFO - 添加多头目标: DOGEUSDT, 数量=41.0
2025-05-29 17:36:45,523 - TradingBot - INFO - KAVAUSDT 数量调整: 21.7711330762987 -> 21.8, 最小值: 0.1, 最大值: 1000000.0, 名义价值=9.20832, 真实保证金=3.069440, 数量精度=1
2025-05-29 17:36:45,525 - TradingBot - INFO - 添加多头目标: KAVAUSDT, 数量=21.8
2025-05-29 17:36:45,525 - TradingBot - WARNING - 交易对 KEYUSDT 不可交易，跳过
2025-05-29 17:36:45,525 - TradingBot - WARNING - 交易对 STPTUSDT 不可交易，跳过
2025-05-29 17:36:45,525 - TradingBot - WARNING - 交易对 AMBUSDT 不可交易，跳过
2025-05-29 17:36:45,525 - TradingBot - WARNING - 交易对 REEFUSDT 不可交易，跳过
2025-05-29 17:36:45,526 - TradingBot - WARNING - 交易对 SCUSDT 不可交易，跳过
2025-05-29 17:36:46,054 - TradingBot - INFO - TRXUSDT 数量调整: 33.13322504568031 -> 33.0, 最小值: 1.0, 最大值: 10000000.0, 名义价值=9.15915, 真实保证金=3.053050, 数量精度=0
2025-05-29 17:36:46,056 - TradingBot - INFO - 添加多头目标: TRXUSDT, 数量=33.0
2025-05-29 17:36:46,056 - TradingBot - WARNING - 交易对 SLPUSDT 不可交易，跳过
2025-05-29 17:36:46,057 - TradingBot - WARNING - 交易对 DGBUSDT 不可交易，跳过
2025-05-29 17:36:46,057 - TradingBot - WARNING - 交易对 MDTUSDT 不可交易，跳过
2025-05-29 17:36:46,057 - TradingBot - WARNING - 交易对 RENUSDT 不可交易，跳过
2025-05-29 17:36:46,624 - TradingBot - INFO - IOSTUSDT 数量调整: 2389.845792990793 -> 2390.0, 最小值: 1.0, 最大值: 80000000.0, 名义价值=9.19672, 真实保证金=3.065573, 数量精度=0
2025-05-29 17:36:46,626 - TradingBot - INFO - 添加多头目标: IOSTUSDT, 数量=2390.0
2025-05-29 17:36:47,245 - TradingBot - INFO - PROMUSDT 数量调整: 1.7096349900406342 -> 1.7, 最小值: 0.1, 最大值: 100000.0, 名义价值=9.1443, 真实保证金=3.048100, 数量精度=1
2025-05-29 17:36:47,245 - TradingBot - INFO - 添加多头目标: PROMUSDT, 数量=1.7
2025-05-29 17:36:47,746 - TradingBot - INFO - XRPUSDT 数量调整: 4.0101720789414665 -> 4.0, 最小值: 0.1, 最大值: 10000000.0, 名义价值=9.1728, 真实保证金=3.057600, 数量精度=1
2025-05-29 17:36:47,746 - TradingBot - INFO - 添加多头目标: XRPUSDT, 数量=4.0
2025-05-29 17:36:48,261 - TradingBot - INFO - AERGOUSDT 数量调整: 63.31240352102287 -> 63.0, 最小值: 1.0, 最大值: 4000000.0, 名义价值=9.150749999999999, 真实保证金=3.050250, 数量精度=0
2025-05-29 17:36:48,261 - TradingBot - INFO - 添加空头目标: AERGOUSDT, 数量=-63.0
2025-05-29 17:36:48,865 - TradingBot - INFO - FLMUSDT 数量调整: 191.58597107142856 -> 192.0, 最小值: 1.0, 最大值: 15000000.0, 名义价值=9.216000000000001, 真实保证金=3.072000, 数量精度=0
2025-05-29 17:36:48,866 - TradingBot - INFO - 添加空头目标: FLMUSDT, 数量=-192.0
2025-05-29 17:36:49,542 - TradingBot - INFO - OMUSDT 数量调整: 23.40159964228458 -> 23.4, 最小值: 0.1, 最大值: 10000000.0, 名义价值=9.195497999999999, 真实保证金=3.065166, 数量精度=1
2025-05-29 17:36:49,543 - TradingBot - INFO - 添加空头目标: OMUSDT, 数量=-23.4
2025-05-29 17:36:50,064 - TradingBot - INFO - DASHUSDT 数量调整: 0.3878585664879195 -> 0.388, 最小值: 0.001, 最大值: 10000.0, 名义价值=9.199480000000001, 真实保证金=3.066493, 数量精度=3
2025-05-29 17:36:50,065 - TradingBot - INFO - 添加空头目标: DASHUSDT, 数量=-0.388
2025-05-29 17:36:50,595 - TradingBot - INFO - CRVUSDT 数量调整: 11.759752700036536 -> 11.8, 最小值: 0.1, 最大值: 1000000.0, 名义价值=9.2276, 真实保证金=3.075867, 数量精度=1
2025-05-29 17:36:50,595 - TradingBot - INFO - 添加空头目标: CRVUSDT, 数量=-11.8
2025-05-29 17:36:51,088 - TradingBot - INFO - CAKEUSDT 数量调整: 3.3062941725133284 -> 3.0, 最小值: 1.0, 最大值: 1000000.0, 名义价值=8.3442, 真实保证金=2.781400, 数量精度=0
2025-05-29 17:36:51,088 - TradingBot - INFO - 添加空头目标: CAKEUSDT, 数量=-3.0
2025-05-29 17:36:51,641 - TradingBot - WARNING - BCHUSDT 数量调整为 0 (因名义价值 9.31128 小于最小值 20.0)
2025-05-29 17:36:51,642 - TradingBot - INFO - BCHUSDT 数量调整: 0.021727924136255013 -> 0, 最小值: 0.001, 最大值: 10000.0, 名义价值=0.0, 真实保证金=0.000000, 数量精度=3
2025-05-29 17:36:51,642 - TradingBot - WARNING - BCHUSDT 数量调整为 0，跳过
2025-05-29 17:36:52,319 - TradingBot - INFO - DFUSDT 数量调整: 184.6241038230992 -> 185.0, 最小值: 1.0, 最大值: 5000000.0, 名义价值=9.21485, 真实保证金=3.071617, 数量精度=0
2025-05-29 17:36:52,320 - TradingBot - INFO - 添加空头目标: DFUSDT, 数量=-185.0
2025-05-29 17:36:52,320 - TradingBot - INFO - 初始化目标持仓: {'MKRUSDT': 0.005, 'DOGEUSDT': 41.0, 'KAVAUSDT': 21.8, 'TRXUSDT': 33.0, 'IOSTUSDT': 2390.0, 'PROMUSDT': 1.7, 'XRPUSDT': 4.0, 'AERGOUSDT': -63.0, 'FLMUSDT': -192.0, 'OMUSDT': -23.4, 'DASHUSDT': -0.388, 'CRVUSDT': -11.8, 'CAKEUSDT': -3.0, 'DFUSDT': -185.0}
2025-05-29 17:36:52,501 - TradingBot - INFO - 获取到 14 个非零持仓
2025-05-29 17:36:52,502 - TradingBot - INFO - ==================== 开始持续限价单调仓 ====================
2025-05-29 17:36:52,502 - TradingBot - INFO - 开始第 1 轮调仓...
2025-05-29 17:36:52,720 - TradingBot - INFO - 第 1 轮开始时可用余额: 5.87968536
2025-05-29 17:36:52,918 - TradingBot - INFO - 第 1 轮: 处理平仓 OMUSDT BUY, 需求数量=0.10000000000000142
2025-05-29 17:36:53,588 - TradingBot - INFO - OMUSDT 平仓数量调整: 0.10000000000000142 -> 0.1, 最小值: 0.1, 最大值: 10000000.0, 名义价值=0.039302000000000004, 真实保证金=0.013101, 数量精度=1
2025-05-29 17:36:53,588 - TradingBot - INFO - 第 1 轮: OMUSDT 平仓调整后数量=0.1
2025-05-29 17:36:53,588 - TradingBot - INFO - 第 1 轮: OMUSDT 为平仓操作，跳过余额检查
2025-05-29 17:36:53,726 - TradingBot - INFO - 第 1 轮: 准备平仓挂单 OMUSDT BUY, 数量=0.1, 价格=0.39302000000000004, is_close=True
2025-05-29 17:36:53,872 - TradingBot - INFO - OMUSDT 杠杆设置为 3
2025-05-29 17:36:53,872 - TradingBot - INFO - OMUSDT 杠杆已设置为 3, is_close=True
2025-05-29 17:36:54,129 - TradingBot - INFO - OMUSDT 为平仓订单 (reduceOnly=True)，跳过保证金检查
2025-05-29 17:36:54,367 - TradingBot - INFO - OMUSDT postonly 挂单成功: 方向=BUY, 数量=0.1, 价格=0.39302, 订单ID=6873200898, is_close=True, reduceOnly=True
2025-05-29 17:36:54,560 - TradingBot - INFO - 第 1 轮: OMUSDT 平仓挂单结果 success=True, order_id=6873200898, order={'orderId': 6873200898, 'symbol': 'OMUSDT', 'status': 'NEW', 'clientOrderId': 'x-Cb7ytekJ9c0d0bd9b488af286b0b3d', 'price': '0.3930200', 'avgPrice': '0.00', 'origQty': '0.1', 'executedQty': '0.0', 'cumQty': '0.0', 'cumQuote': '0.00000000', 'timeInForce': 'GTX', 'type': 'LIMIT', 'reduceOnly': True, 'closePosition': False, 'side': 'BUY', 'positionSide': 'BOTH', 'stopPrice': '0.0000000', 'workingType': 'CONTRACT_PRICE', 'priceProtect': False, 'origType': 'LIMIT', 'priceMatch': 'NONE', 'selfTradePreventionMode': 'EXPIRE_MAKER', 'goodTillDate': 0, 'updateTime': 1748511414312}
2025-05-29 17:36:54,560 - TradingBot - INFO - 第 1 轮: OMUSDT BUY postOnly 平仓挂单成功，订单ID=6873200898, is_close=True
2025-05-29 17:36:54,560 - TradingBot - INFO - 第 1 轮: 处理平仓 FLMUSDT BUY, 需求数量=3.0
2025-05-29 17:36:55,122 - TradingBot - INFO - FLMUSDT 平仓数量调整: 3.0 -> 3.0, 最小值: 1.0, 最大值: 15000000.0, 名义价值=0.14400000000000002, 真实保证金=0.048000, 数量精度=0
2025-05-29 17:36:55,123 - TradingBot - INFO - 第 1 轮: FLMUSDT 平仓调整后数量=3.0
2025-05-29 17:36:55,123 - TradingBot - INFO - 第 1 轮: FLMUSDT 为平仓操作，跳过余额检查
2025-05-29 17:36:55,322 - TradingBot - INFO - 第 1 轮: 准备平仓挂单 FLMUSDT BUY, 数量=3.0, 价格=0.048, is_close=True
2025-05-29 17:36:55,475 - TradingBot - INFO - FLMUSDT 杠杆设置为 3
2025-05-29 17:36:55,475 - TradingBot - INFO - FLMUSDT 杠杆已设置为 3, is_close=True
2025-05-29 17:36:55,644 - TradingBot - INFO - FLMUSDT 为平仓订单 (reduceOnly=True)，跳过保证金检查
2025-05-29 17:36:55,803 - TradingBot - INFO - FLMUSDT postonly 挂单成功: 方向=BUY, 数量=3.0, 价格=0.048, 订单ID=8393493699, is_close=True, reduceOnly=True
2025-05-29 17:36:55,942 - TradingBot - INFO - 第 1 轮: FLMUSDT 平仓挂单结果 success=True, order_id=8393493699, order={'orderId': 8393493699, 'symbol': 'FLMUSDT', 'status': 'NEW', 'clientOrderId': 'x-Cb7ytekJ7d036680fa4a7ca2da0a79', 'price': '0.0480', 'avgPrice': '0.00', 'origQty': '3', 'executedQty': '0', 'cumQty': '0', 'cumQuote': '0.0000', 'timeInForce': 'GTX', 'type': 'LIMIT', 'reduceOnly': True, 'closePosition': False, 'side': 'BUY', 'positionSide': 'BOTH', 'stopPrice': '0.0000', 'workingType': 'CONTRACT_PRICE', 'priceProtect': False, 'origType': 'LIMIT', 'priceMatch': 'NONE', 'selfTradePreventionMode': 'EXPIRE_MAKER', 'goodTillDate': 0, 'updateTime': 1748511415758}
2025-05-29 17:36:55,942 - TradingBot - INFO - 第 1 轮: FLMUSDT BUY postOnly 平仓挂单成功，订单ID=8393493699, is_close=True
2025-05-29 17:36:55,942 - TradingBot - INFO - 第 1 轮开仓前可用余额: 5.87968536, 开仓需求: {'OMUSDT': 0.0, 'IOSTUSDT': 9.0, 'AERGOUSDT': -3.0, 'DFUSDT': -8.0, 'FLMUSDT': 0.0, 'CRVUSDT': -0.20000000000000107, 'DASHUSDT': -0.020000000000000018}
2025-05-29 17:36:55,942 - TradingBot - INFO - 第 1 轮: 跳过 OMUSDT 开仓，原因：数量为0或已处理
2025-05-29 17:36:55,942 - TradingBot - INFO - 第 1 轮: 处理开仓 IOSTUSDT BUY, 需求数量=9.0
2025-05-29 17:36:56,420 - TradingBot - WARNING - IOSTUSDT 数量调整为 0 (因名义价值 0.034623 小于最小值 5.0)
2025-05-29 17:36:56,420 - TradingBot - INFO - IOSTUSDT 数量调整: 9.0 -> 0, 最小值: 1.0, 最大值: 80000000.0, 名义价值=0.0, 真实保证金=0.000000, 数量精度=0
2025-05-29 17:36:56,421 - TradingBot - INFO - 第 1 轮: IOSTUSDT 开仓调整后数量=0, is_reverse_open=False
2025-05-29 17:36:56,421 - TradingBot - WARNING - 第 1 轮: IOSTUSDT 调整数量为 0，跳过
2025-05-29 17:36:56,422 - TradingBot - INFO - 第 1 轮: 处理开仓 AERGOUSDT SELL, 需求数量=-3.0
2025-05-29 17:36:56,915 - TradingBot - WARNING - AERGOUSDT 数量调整为 0 (因名义价值 0.4357500000000001 小于最小值 5.0)
2025-05-29 17:36:56,915 - TradingBot - INFO - AERGOUSDT 数量调整: 3.0 -> 0, 最小值: 1.0, 最大值: 4000000.0, 名义价值=0.0, 真实保证金=0.000000, 数量精度=0
2025-05-29 17:36:56,915 - TradingBot - INFO - 第 1 轮: AERGOUSDT 开仓调整后数量=0, is_reverse_open=False
2025-05-29 17:36:56,915 - TradingBot - WARNING - 第 1 轮: AERGOUSDT 调整数量为 0，跳过
2025-05-29 17:36:56,915 - TradingBot - INFO - 第 1 轮: 处理开仓 DFUSDT SELL, 需求数量=-8.0
2025-05-29 17:36:57,443 - TradingBot - WARNING - DFUSDT 数量调整为 0 (因名义价值 0.39848000000000006 小于最小值 5.0)
2025-05-29 17:36:57,443 - TradingBot - INFO - DFUSDT 数量调整: 8.0 -> 0, 最小值: 1.0, 最大值: 5000000.0, 名义价值=0.0, 真实保证金=0.000000, 数量精度=0
2025-05-29 17:36:57,444 - TradingBot - INFO - 第 1 轮: DFUSDT 开仓调整后数量=0, is_reverse_open=False
2025-05-29 17:36:57,444 - TradingBot - WARNING - 第 1 轮: DFUSDT 调整数量为 0，跳过
2025-05-29 17:36:57,444 - TradingBot - INFO - 第 1 轮: 跳过 FLMUSDT 开仓，原因：数量为0或已处理
2025-05-29 17:36:57,444 - TradingBot - INFO - 第 1 轮: 处理开仓 CRVUSDT SELL, 需求数量=-0.20000000000000107
2025-05-29 17:36:58,010 - TradingBot - WARNING - CRVUSDT 数量调整为 0 (因名义价值 0.15680000000000002 小于最小值 5.0)
2025-05-29 17:36:58,010 - TradingBot - INFO - CRVUSDT 数量调整: 0.20000000000000107 -> 0, 最小值: 0.1, 最大值: 1000000.0, 名义价值=0.0, 真实保证金=0.000000, 数量精度=1
2025-05-29 17:36:58,010 - TradingBot - INFO - 第 1 轮: CRVUSDT 开仓调整后数量=0, is_reverse_open=False
2025-05-29 17:36:58,010 - TradingBot - WARNING - 第 1 轮: CRVUSDT 调整数量为 0，跳过
2025-05-29 17:36:58,010 - TradingBot - INFO - 第 1 轮: 处理开仓 DASHUSDT SELL, 需求数量=-0.020000000000000018
2025-05-29 17:36:58,500 - TradingBot - WARNING - DASHUSDT 数量调整为 0 (因名义价值 0.4744 小于最小值 5.0)
2025-05-29 17:36:58,500 - TradingBot - INFO - DASHUSDT 数量调整: 0.020000000000000018 -> 0, 最小值: 0.001, 最大值: 10000.0, 名义价值=0.0, 真实保证金=0.000000, 数量精度=3
2025-05-29 17:36:58,502 - TradingBot - INFO - 第 1 轮: DASHUSDT 开仓调整后数量=0, is_reverse_open=False
2025-05-29 17:36:58,503 - TradingBot - WARNING - 第 1 轮: DASHUSDT 调整数量为 0，跳过
2025-05-29 17:36:58,503 - TradingBot - INFO - 第 1 轮挂单等待，最多 30 秒...
2025-05-29 17:37:03,389 - TradingBot - INFO - 第 1 轮: OMUSDT BUY 单已成交，订单ID=6873200898, 成交数量=0.1, 均价=0.39302000000000004
2025-05-29 17:37:03,389 - TradingBot - INFO - 第 1 轮: OMUSDT BUY 已完全成交，订单ID=6873200898, 成交数量=0.1
2025-05-29 17:37:14,601 - TradingBot - INFO - 第 1 轮: FLMUSDT BUY 单已成交，订单ID=8393493699, 成交数量=3.0, 均价=0.04800000000000001
2025-05-29 17:37:14,601 - TradingBot - INFO - 第 1 轮: FLMUSDT BUY 已完全成交，订单ID=8393493699, 成交数量=3.0
2025-05-29 17:37:14,601 - TradingBot - INFO - 第 1 轮所有挂单已处理完成，提前结束等待
2025-05-29 17:37:14,758 - TradingBot - INFO - 获取到 14 个非零持仓
2025-05-29 17:37:15,254 - TradingBot - INFO - IOSTUSDT 平仓数量调整: 9.0 -> 9.0, 最小值: 1.0, 最大值: 80000000.0, 名义价值=0.034614, 真实保证金=0.011538, 数量精度=0
2025-05-29 17:37:15,254 - TradingBot - INFO - 第 1 轮: IOSTUSDT 差值 9.0 为小额调整（名义价值 0.034614 < 5 或数量过小），跳过后续轮次
2025-05-29 17:37:15,752 - TradingBot - INFO - AERGOUSDT 平仓数量调整: 3.0 -> 3.0, 最小值: 1.0, 最大值: 4000000.0, 名义价值=0.43574999999999997, 真实保证金=0.145250, 数量精度=0
2025-05-29 17:37:15,753 - TradingBot - INFO - 第 1 轮: AERGOUSDT 差值 -3.0 为小额调整（名义价值 0.43574999999999997 < 5 或数量过小），跳过后续轮次
2025-05-29 17:37:16,323 - TradingBot - INFO - DFUSDT 平仓数量调整: 8.0 -> 8.0, 最小值: 1.0, 最大值: 5000000.0, 名义价值=0.39904, 真实保证金=0.133013, 数量精度=0
2025-05-29 17:37:16,324 - TradingBot - INFO - 第 1 轮: DFUSDT 差值 -8.0 为小额调整（名义价值 0.39904 < 5 或数量过小），跳过后续轮次
2025-05-29 17:37:16,957 - TradingBot - INFO - CRVUSDT 平仓数量调整: 0.20000000000000107 -> 0.2, 最小值: 0.1, 最大值: 1000000.0, 名义价值=0.15660000000000002, 真实保证金=0.052200, 数量精度=1
2025-05-29 17:37:16,958 - TradingBot - INFO - 第 1 轮: CRVUSDT 差值 -0.20000000000000107 为小额调整（名义价值 0.15660000000000002 < 5 或数量过小），跳过后续轮次
2025-05-29 17:37:17,456 - TradingBot - INFO - DASHUSDT 平仓数量调整: 0.020000000000000018 -> 0.02, 最小值: 0.001, 最大值: 10000.0, 名义价值=0.4742, 真实保证金=0.158067, 数量精度=3
2025-05-29 17:37:17,456 - TradingBot - INFO - 第 1 轮: DASHUSDT 差值 -0.020000000000000018 为小额调整（名义价值 0.4742 < 5 或数量过小），跳过后续轮次
2025-05-29 17:37:17,456 - TradingBot - INFO - 第 1 轮完成，剩余需求: {}
2025-05-29 17:37:17,456 - TradingBot - INFO - 第 1 轮后所有目标已达成，结束限价单调仓
2025-05-29 17:37:17,456 - TradingBot - INFO - ==================== 市价单补齐：后续调仓 ====================
2025-05-29 17:37:17,588 - TradingBot - INFO - 获取到 14 个非零持仓
2025-05-29 17:37:17,588 - TradingBot - INFO - 市价单补齐：所有目标已达成，无需补齐
2025-05-29 17:37:45,294 - TradingBot - INFO - 账户信息已保存为JSON文件: data/account_info_20250529_173745.json
2025-05-29 17:37:45,436 - TradingBot - ERROR - 计算回报率失败: Unknown datetime string format, unable to parse: 2025-05-29_17:37:45, at position 0
2025-05-29 17:37:46,017 - TradingBot - INFO - 成功写入 14 条指标到 data/account_metrics.xlsx，Run_ID=2025-05-29_173642
2025-05-29 17:37:46,017 - TradingBot - INFO - ✅ 交易引擎执行完成 | RunID: 2025-05-29_173642
2025-05-29 17:37:46,017 - TradingBot - INFO - 当前日期: 2025-05-29, Run_ID: 2025-05-29_173642
2025-05-29 17:37:46,021 - TradingBot - INFO - 读取 data/positions_output.csv，去重后包含 123 条记录
2025-05-29 17:37:46,022 - TradingBot - INFO - 找到 0 条 Run_ID=2025-05-29_173642 或日期=2025-05-29 的记录
2025-05-29 17:37:46,022 - TradingBot - INFO - 当前 Run_ID 无持仓数据，创建空结果
2025-05-29 17:37:46,023 - TradingBot - INFO - 正持仓数量: 0, 负持仓数量: 0
2025-05-29 17:37:46,025 - TradingBot - INFO - 资金费率文件 data/pos20250529_v3.csv 已加载，去重后包含 173 条记录
2025-05-29 17:37:46,026 - TradingBot - INFO - 已为 7 个黑名单币种设置 ErrorReason: 黑名单过滤
2025-05-29 17:37:46,026 - TradingBot - INFO - 已为 16 个币种映射其他错误原因
2025-05-29 17:37:46,028 - TradingBot - INFO - 无有效持仓数据，生成空结果
2025-05-29 17:37:46,116 - TradingBot - INFO - 分析结果已去重并追加写入文件: data/position_analysis.xlsx，记录数: 237
2025-05-29 17:37:46,244 - TradingBot - INFO - 唯一日期数量为 8，执行可视化...
2025-05-29 17:37:46,355 - TradingBot - INFO - 添加附件: data\position_analysis.xlsx
2025-05-29 17:37:46,355 - TradingBot - INFO - 未找到可视化 PDF 文件: data\2025-05-29_account_metrics_data_visualization.pdf
2025-05-29 17:37:46,367 - TradingBot - INFO - 尝试连接到 smtp.gmail.com:465 (第 1/5)
2025-05-29 17:37:47,291 - TradingBot - INFO - 连接成功，开始登录
2025-05-29 17:37:51,105 - TradingBot - INFO - 邮件发送成功！
2025-05-29 17:37:51,350 - TradingBot - INFO - 20250529 交易完成，Run_ID: 2025-05-29_173642
2025-05-29 17:37:51,350 - TradingBot - INFO - 记录已处理文件 data/pos20250529_v3.csv，哈希: f15f859a3ed30157e3a3be2755a85d1b，Run_ID: 2025-05-29_173642
2025-05-29 17:37:51,350 - TradingBot - INFO - 交易完成后等待 10 分钟
2025-05-29 17:41:21,150 - TradingBot - INFO - 日志初始化成功，当前日志文件: logs\trading_2025-05-29.log
2025-05-29 17:41:21,150 - TradingBot - INFO - 交易程序启动，进入日内多次换仓模式
2025-05-29 17:41:21,922 - TradingBot - INFO - Binance 客户端初始化成功，测试网络: False
2025-05-29 17:41:22,725 - TradingBot - INFO - 所有交易对已是全仓模式 (CROSSED)，无需修改
2025-05-29 17:41:23,073 - TradingBot - INFO - 账户已是单币种模式 (Single)，无需修改
2025-05-29 17:41:23,351 - TradingBot - INFO - 账户已是单向模式 (One-way)，无需修改
2025-05-29 17:41:23,791 - TradingBot - INFO - 检查 20250529 的文件或邮件，Run_ID: 2025-05-29_174123
2025-05-29 17:41:23,791 - TradingBot - INFO - 检查本地文件: data/pos20250529_v3.csv
2025-05-29 17:41:23,792 - TradingBot - INFO - 本地找到文件 data/pos20250529_v3.csv，哈希: f15f859a3ed30157e3a3be2755a85d1b，未处理，直接使用
2025-05-29 17:41:23,792 - TradingBot - INFO - 处理 20250529 的pos文件，Run_ID: 2025-05-29_174123
2025-05-29 17:41:23,792 - TradingBot - INFO - 🚀 开始执行交易引擎 | Date: 20250529 | RunID: 2025-05-29_174123
2025-05-29 17:41:24,807 - TradingBot - INFO - 当前没有未成交的挂单
2025-05-29 17:41:24,811 - TradingBot - INFO - 📋 黑名单过滤结果
├─ 被过滤币种 (7个): BADGERUSDT, BALUSDT, LINAUSDT, NULSUSDT, SNTUSDT, TROYUSDT, VIDTUSDT
└─ 剩余候选池: 166/173
2025-05-29 17:41:24,815 - TradingBot - INFO - 🔍 有效候选列表
├─ 多头候选: 82个
└─ 空头候选: 84个
2025-05-29 17:41:25,324 - TradingBot - INFO - =====账户信息获取成功: totalMarginBalance = 47.91642744, available_balance = 5.95688974=====
2025-05-29 17:41:25,324 - TradingBot - INFO - 每笔交易资金份额: per_share=3.065459102857143
2025-05-29 17:41:25,601 - TradingBot - INFO - 获取到 14 个非零持仓
2025-05-29 17:41:25,601 - TradingBot - INFO - 当前持仓: {'TRXUSDT': 33.0, 'PROMUSDT': 1.7, 'CRVUSDT': -11.6, 'FLMUSDT': -192.0, 'OMUSDT': -23.4, 'MKRUSDT': 0.005, 'DOGEUSDT': 41.0, 'DASHUSDT': -0.368, 'KAVAUSDT': 21.8, 'IOSTUSDT': 2381.0, 'AERGOUSDT': -60.0, 'XRPUSDT': 4.0, 'DFUSDT': -177.0, 'CAKEUSDT': -3.0}, 是否第一天: False
2025-05-29 17:41:25,830 - TradingBot - INFO - 交易所信息获取成功
2025-05-29 17:41:26,478 - TradingBot - WARNING - BTCUSDT 数量调整为 0 (原值: 0 小于最小值: 0.001)
2025-05-29 17:41:26,479 - TradingBot - WARNING - BTCUSDT 数量调整为 0 (因名义价值 0.0 小于最小值 100.0)
2025-05-29 17:41:26,479 - TradingBot - INFO - BTCUSDT 数量调整: 8.489789138179062e-05 -> 0, 最小值: 0.001, 最大值: 1000.0, 名义价值=0.0, 真实保证金=0.000000, 数量精度=3
2025-05-29 17:41:26,479 - TradingBot - WARNING - BTCUSDT 数量调整为 0，跳过
2025-05-29 17:41:27,118 - TradingBot - INFO - MKRUSDT 数量调整: 0.005288617694273062 -> 0.005, 最小值: 0.001, 最大值: 10000.0, 名义价值=8.694500000000001, 真实保证金=2.898167, 数量精度=3
2025-05-29 17:41:27,118 - TradingBot - INFO - 添加多头目标: MKRUSDT, 数量=0.005
2025-05-29 17:41:27,691 - TradingBot - INFO - DOGEUSDT 数量调整: 40.83830236054633 -> 41.0, 最小值: 1.0, 最大值: 50000000.0, 名义价值=9.23279, 真实保证金=3.077597, 数量精度=0
2025-05-29 17:41:27,692 - TradingBot - INFO - 添加多头目标: DOGEUSDT, 数量=41.0
2025-05-29 17:41:28,230 - TradingBot - INFO - KAVAUSDT 数量调整: 21.761422878777633 -> 21.8, 最小值: 0.1, 最大值: 1000000.0, 名义价值=9.21268, 真实保证金=3.070893, 数量精度=1
2025-05-29 17:41:28,230 - TradingBot - INFO - 添加多头目标: KAVAUSDT, 数量=21.8
2025-05-29 17:41:28,230 - TradingBot - WARNING - 交易对 KEYUSDT 不可交易，跳过
2025-05-29 17:41:28,230 - TradingBot - WARNING - 交易对 STPTUSDT 不可交易，跳过
2025-05-29 17:41:28,230 - TradingBot - WARNING - 交易对 AMBUSDT 不可交易，跳过
2025-05-29 17:41:28,230 - TradingBot - WARNING - 交易对 REEFUSDT 不可交易，跳过
2025-05-29 17:41:28,231 - TradingBot - WARNING - 交易对 SCUSDT 不可交易，跳过
2025-05-29 17:41:28,781 - TradingBot - INFO - TRXUSDT 数量调整: 33.16160864189899 -> 33.0, 最小值: 1.0, 最大值: 10000000.0, 名义价值=9.15156, 真实保证金=3.050520, 数量精度=0
2025-05-29 17:41:28,781 - TradingBot - INFO - 添加多头目标: TRXUSDT, 数量=33.0
2025-05-29 17:41:28,782 - TradingBot - WARNING - 交易对 SLPUSDT 不可交易，跳过
2025-05-29 17:41:28,782 - TradingBot - WARNING - 交易对 DGBUSDT 不可交易，跳过
2025-05-29 17:41:28,782 - TradingBot - WARNING - 交易对 MDTUSDT 不可交易，跳过
2025-05-29 17:41:28,782 - TradingBot - WARNING - 交易对 RENUSDT 不可交易，跳过
2025-05-29 17:41:29,611 - TradingBot - INFO - IOSTUSDT 数量调整: 2393.0203769376603 -> 2393.0, 最小值: 1.0, 最大值: 80000000.0, 名义价值=9.196299, 真实保证金=3.065433, 数量精度=0
2025-05-29 17:41:29,611 - TradingBot - INFO - 添加多头目标: IOSTUSDT, 数量=2393.0
2025-05-29 17:41:30,471 - TradingBot - INFO - PROMUSDT 数量调整: 1.7093638120021242 -> 1.7, 最小值: 0.1, 最大值: 100000.0, 名义价值=9.145999999999999, 真实保证金=3.048667, 数量精度=1
2025-05-29 17:41:30,471 - TradingBot - INFO - 添加多头目标: PROMUSDT, 数量=1.7
2025-05-29 17:41:31,007 - TradingBot - INFO - XRPUSDT 数量调整: 4.012030934722724 -> 4.0, 最小值: 0.1, 最大值: 10000000.0, 名义价值=9.1688, 真实保证金=3.056267, 数量精度=1
2025-05-29 17:41:31,007 - TradingBot - INFO - 添加多头目标: XRPUSDT, 数量=4.0
2025-05-29 17:41:31,547 - TradingBot - INFO - AERGOUSDT 数量调整: 63.292342109920355 -> 63.0, 最小值: 1.0, 最大值: 4000000.0, 名义价值=9.1539, 真实保证金=3.051300, 数量精度=0
2025-05-29 17:41:31,548 - TradingBot - INFO - 添加空头目标: AERGOUSDT, 数量=-63.0
2025-05-29 17:41:32,151 - TradingBot - INFO - FLMUSDT 数量调整: 192.39283072325162 -> 192.0, 最小值: 1.0, 最大值: 15000000.0, 名义价值=9.1776, 真实保证金=3.059200, 数量精度=0
2025-05-29 17:41:32,152 - TradingBot - INFO - 添加空头目标: FLMUSDT, 数量=-192.0
2025-05-29 17:41:32,752 - TradingBot - INFO - OMUSDT 数量调整: 23.43862093121477 -> 23.4, 最小值: 0.1, 最大值: 10000000.0, 名义价值=9.181223999999998, 真实保证金=3.060408, 数量精度=1
2025-05-29 17:41:32,753 - TradingBot - INFO - 添加空头目标: OMUSDT, 数量=-23.4
2025-05-29 17:41:33,341 - TradingBot - INFO - DASHUSDT 数量调整: 0.387542238035037 -> 0.388, 最小值: 0.001, 最大值: 10000.0, 名义价值=9.20724, 真实保证金=3.069080, 数量精度=3
2025-05-29 17:41:33,342 - TradingBot - INFO - 添加空头目标: DASHUSDT, 数量=-0.388
2025-05-29 17:41:33,842 - TradingBot - INFO - CRVUSDT 数量调整: 11.715130329390353 -> 11.7, 最小值: 0.1, 最大值: 1000000.0, 名义价值=9.1845, 真实保证金=3.061500, 数量精度=1
2025-05-29 17:41:33,843 - TradingBot - INFO - 添加空头目标: CRVUSDT, 数量=-11.7
2025-05-29 17:41:34,348 - TradingBot - INFO - CAKEUSDT 数量调整: 3.302703289126029 -> 3.0, 最小值: 1.0, 最大值: 1000000.0, 名义价值=8.3535, 真实保证金=2.784500, 数量精度=0
2025-05-29 17:41:34,349 - TradingBot - INFO - 添加空头目标: CAKEUSDT, 数量=-3.0
2025-05-29 17:41:35,744 - TradingBot - WARNING - BCHUSDT 数量调整为 0 (因名义价值 9.297419999999999 小于最小值 20.0)
2025-05-29 17:41:35,744 - TradingBot - INFO - BCHUSDT 数量调整: 0.021760907949578637 -> 0, 最小值: 0.001, 最大值: 10000.0, 名义价值=0.0, 真实保证金=0.000000, 数量精度=3
2025-05-29 17:41:35,744 - TradingBot - WARNING - BCHUSDT 数量调整为 0，跳过
2025-05-29 17:41:38,509 - TradingBot - INFO - DFUSDT 数量调整: 184.443989341585 -> 184.0, 最小值: 1.0, 最大值: 5000000.0, 名义价值=9.174240000000001, 真实保证金=3.058080, 数量精度=0
2025-05-29 17:41:38,509 - TradingBot - INFO - 添加空头目标: DFUSDT, 数量=-184.0
2025-05-29 17:41:38,509 - TradingBot - INFO - 初始化目标持仓: {'MKRUSDT': 0.005, 'DOGEUSDT': 41.0, 'KAVAUSDT': 21.8, 'TRXUSDT': 33.0, 'IOSTUSDT': 2393.0, 'PROMUSDT': 1.7, 'XRPUSDT': 4.0, 'AERGOUSDT': -63.0, 'FLMUSDT': -192.0, 'OMUSDT': -23.4, 'DASHUSDT': -0.388, 'CRVUSDT': -11.7, 'CAKEUSDT': -3.0, 'DFUSDT': -184.0}
2025-05-29 17:41:38,677 - TradingBot - INFO - 获取到 14 个非零持仓
2025-05-29 17:41:38,678 - TradingBot - INFO - ==================== 开始持续限价单调仓 ====================
2025-05-29 17:41:38,678 - TradingBot - INFO - 开始第 1 轮调仓...
2025-05-29 17:41:38,866 - TradingBot - INFO - 第 1 轮开始时可用余额: 5.90604467
2025-05-29 17:41:39,324 - TradingBot - INFO - 第 1 轮开仓前可用余额: 5.90604467, 开仓需求: {'DFUSDT': -7.0, 'IOSTUSDT': 12.0, 'AERGOUSDT': -3.0, 'DASHUSDT': -0.020000000000000018, 'CRVUSDT': -0.09999999999999964}
2025-05-29 17:41:39,324 - TradingBot - INFO - 第 1 轮: 处理开仓 DFUSDT SELL, 需求数量=-7.0
2025-05-29 17:41:39,850 - TradingBot - WARNING - DFUSDT 数量调整为 0 (因名义价值 0.34909 小于最小值 5.0)
2025-05-29 17:41:39,850 - TradingBot - INFO - DFUSDT 数量调整: 7.0 -> 0, 最小值: 1.0, 最大值: 5000000.0, 名义价值=0.0, 真实保证金=0.000000, 数量精度=0
2025-05-29 17:41:39,851 - TradingBot - INFO - 第 1 轮: DFUSDT 开仓调整后数量=0, is_reverse_open=False
2025-05-29 17:41:39,851 - TradingBot - WARNING - 第 1 轮: DFUSDT 调整数量为 0，跳过
2025-05-29 17:41:39,851 - TradingBot - INFO - 第 1 轮: 处理开仓 IOSTUSDT BUY, 需求数量=12.0
2025-05-29 17:41:40,415 - TradingBot - WARNING - IOSTUSDT 数量调整为 0 (因名义价值 0.046104 小于最小值 5.0)
2025-05-29 17:41:40,415 - TradingBot - INFO - IOSTUSDT 数量调整: 12.0 -> 0, 最小值: 1.0, 最大值: 80000000.0, 名义价值=0.0, 真实保证金=0.000000, 数量精度=0
2025-05-29 17:41:40,416 - TradingBot - INFO - 第 1 轮: IOSTUSDT 开仓调整后数量=0, is_reverse_open=False
2025-05-29 17:41:40,416 - TradingBot - WARNING - 第 1 轮: IOSTUSDT 调整数量为 0，跳过
2025-05-29 17:41:40,416 - TradingBot - INFO - 第 1 轮: 处理开仓 AERGOUSDT SELL, 需求数量=-3.0
2025-05-29 17:41:41,011 - TradingBot - WARNING - AERGOUSDT 数量调整为 0 (因名义价值 0.43662 小于最小值 5.0)
2025-05-29 17:41:41,011 - TradingBot - INFO - AERGOUSDT 数量调整: 3.0 -> 0, 最小值: 1.0, 最大值: 4000000.0, 名义价值=0.0, 真实保证金=0.000000, 数量精度=0
2025-05-29 17:41:41,013 - TradingBot - INFO - 第 1 轮: AERGOUSDT 开仓调整后数量=0, is_reverse_open=False
2025-05-29 17:41:41,013 - TradingBot - WARNING - 第 1 轮: AERGOUSDT 调整数量为 0，跳过
2025-05-29 17:41:41,013 - TradingBot - INFO - 第 1 轮: 处理开仓 DASHUSDT SELL, 需求数量=-0.020000000000000018
2025-05-29 17:41:41,486 - TradingBot - WARNING - DASHUSDT 数量调整为 0 (因名义价值 0.4746 小于最小值 5.0)
2025-05-29 17:41:41,486 - TradingBot - INFO - DASHUSDT 数量调整: 0.020000000000000018 -> 0, 最小值: 0.001, 最大值: 10000.0, 名义价值=0.0, 真实保证金=0.000000, 数量精度=3
2025-05-29 17:41:41,487 - TradingBot - INFO - 第 1 轮: DASHUSDT 开仓调整后数量=0, is_reverse_open=False
2025-05-29 17:41:41,487 - TradingBot - WARNING - 第 1 轮: DASHUSDT 调整数量为 0，跳过
2025-05-29 17:41:41,487 - TradingBot - INFO - 第 1 轮: 处理开仓 CRVUSDT SELL, 需求数量=-0.09999999999999964
2025-05-29 17:41:42,039 - TradingBot - WARNING - CRVUSDT 数量调整为 0 (因名义价值 0.0786 小于最小值 5.0)
2025-05-29 17:41:42,040 - TradingBot - INFO - CRVUSDT 数量调整: 0.09999999999999964 -> 0, 最小值: 0.1, 最大值: 1000000.0, 名义价值=0.0, 真实保证金=0.000000, 数量精度=1
2025-05-29 17:41:42,042 - TradingBot - INFO - 第 1 轮: CRVUSDT 开仓调整后数量=0, is_reverse_open=False
2025-05-29 17:41:42,042 - TradingBot - WARNING - 第 1 轮: CRVUSDT 调整数量为 0，跳过
2025-05-29 17:41:42,184 - TradingBot - INFO - 获取到 14 个非零持仓
2025-05-29 17:41:42,705 - TradingBot - INFO - DFUSDT 平仓数量调整: 7.0 -> 7.0, 最小值: 1.0, 最大值: 5000000.0, 名义价值=0.34902, 真实保证金=0.116340, 数量精度=0
2025-05-29 17:41:42,706 - TradingBot - INFO - 第 1 轮: DFUSDT 差值 -7.0 为小额调整（名义价值 0.34902 < 5 或数量过小），跳过后续轮次
2025-05-29 17:41:43,546 - TradingBot - INFO - IOSTUSDT 平仓数量调整: 12.0 -> 12.0, 最小值: 1.0, 最大值: 80000000.0, 名义价值=0.046116000000000004, 真实保证金=0.015372, 数量精度=0
2025-05-29 17:41:43,548 - TradingBot - INFO - 第 1 轮: IOSTUSDT 差值 12.0 为小额调整（名义价值 0.046116000000000004 < 5 或数量过小），跳过后续轮次
2025-05-29 17:41:44,036 - TradingBot - INFO - AERGOUSDT 平仓数量调整: 3.0 -> 3.0, 最小值: 1.0, 最大值: 4000000.0, 名义价值=0.43656000000000006, 真实保证金=0.145520, 数量精度=0
2025-05-29 17:41:44,037 - TradingBot - INFO - 第 1 轮: AERGOUSDT 差值 -3.0 为小额调整（名义价值 0.43656000000000006 < 5 或数量过小），跳过后续轮次
2025-05-29 17:41:44,889 - TradingBot - INFO - DASHUSDT 平仓数量调整: 0.020000000000000018 -> 0.02, 最小值: 0.001, 最大值: 10000.0, 名义价值=0.4746, 真实保证金=0.158200, 数量精度=3
2025-05-29 17:41:44,890 - TradingBot - INFO - 第 1 轮: DASHUSDT 差值 -0.020000000000000018 为小额调整（名义价值 0.4746 < 5 或数量过小），跳过后续轮次
2025-05-29 17:41:45,469 - TradingBot - INFO - CRVUSDT 平仓数量调整: 0.09999999999999964 -> 0.1, 最小值: 0.1, 最大值: 1000000.0, 名义价值=0.07850000000000001, 真实保证金=0.026167, 数量精度=1
2025-05-29 17:41:45,470 - TradingBot - INFO - 第 1 轮: CRVUSDT 差值 -0.09999999999999964 为小额调整（名义价值 0.07850000000000001 < 5 或数量过小），跳过后续轮次
2025-05-29 17:41:45,471 - TradingBot - INFO - 第 1 轮完成，剩余需求: {}
2025-05-29 17:41:45,471 - TradingBot - INFO - 第 1 轮后所有目标已达成，结束限价单调仓
2025-05-29 17:41:45,471 - TradingBot - INFO - ==================== 市价单补齐：后续调仓 ====================
2025-05-29 17:41:45,628 - TradingBot - INFO - 获取到 14 个非零持仓
2025-05-29 17:41:45,628 - TradingBot - INFO - 市价单补齐：所有目标已达成，无需补齐
2025-05-29 17:42:13,111 - TradingBot - INFO - 账户信息已保存为JSON文件: data/account_info_20250529_174213.json
2025-05-29 17:42:13,266 - TradingBot - ERROR - 无法解析当前记录时间: 2025-05-29_17:42:13
2025-05-29 17:42:13,266 - TradingBot - ERROR - 计算回报率失败: Invalid current_record_time: 2025-05-29_17:42:13
2025-05-29 17:42:13,878 - TradingBot - INFO - 成功写入 14 条指标到 data/account_metrics.xlsx，Run_ID=2025-05-29_174123
2025-05-29 17:42:13,879 - TradingBot - INFO - ✅ 交易引擎执行完成 | RunID: 2025-05-29_174123
2025-05-29 17:42:13,879 - TradingBot - INFO - 当前日期: 2025-05-29, Run_ID: 2025-05-29_174123
2025-05-29 17:42:13,882 - TradingBot - INFO - 读取 data/positions_output.csv，去重后包含 123 条记录
2025-05-29 17:42:13,883 - TradingBot - INFO - 找到 0 条 Run_ID=2025-05-29_174123 或日期=2025-05-29 的记录
2025-05-29 17:42:13,883 - TradingBot - INFO - 当前 Run_ID 无持仓数据，创建空结果
2025-05-29 17:42:13,884 - TradingBot - INFO - 正持仓数量: 0, 负持仓数量: 0
2025-05-29 17:42:13,886 - TradingBot - INFO - 资金费率文件 data/pos20250529_v3.csv 已加载，去重后包含 173 条记录
2025-05-29 17:42:13,887 - TradingBot - INFO - 已为 7 个黑名单币种设置 ErrorReason: 黑名单过滤
2025-05-29 17:42:13,888 - TradingBot - INFO - 已为 16 个币种映射其他错误原因
2025-05-29 17:42:13,892 - TradingBot - INFO - 无有效持仓数据，生成空结果
2025-05-29 17:42:13,968 - TradingBot - INFO - 分析结果已去重并追加写入文件: data/position_analysis.xlsx，记录数: 237
2025-05-29 17:42:14,024 - TradingBot - INFO - 唯一日期数量为 8，执行可视化...
2025-05-29 17:42:14,114 - TradingBot - INFO - 添加附件: data\position_analysis.xlsx
2025-05-29 17:42:14,114 - TradingBot - INFO - 未找到可视化 PDF 文件: data\2025-05-29_account_metrics_data_visualization.pdf
2025-05-29 17:42:14,129 - TradingBot - INFO - 尝试连接到 smtp.gmail.com:465 (第 1/5)
2025-05-29 17:42:14,985 - TradingBot - INFO - 连接成功，开始登录
2025-05-29 17:42:18,603 - TradingBot - INFO - 邮件发送成功！
2025-05-29 17:42:18,793 - TradingBot - INFO - 20250529 交易完成，Run_ID: 2025-05-29_174123
2025-05-29 17:42:18,793 - TradingBot - INFO - 记录已处理文件 data/pos20250529_v3.csv，哈希: f15f859a3ed30157e3a3be2755a85d1b，Run_ID: 2025-05-29_174123
2025-05-29 17:42:18,793 - TradingBot - INFO - 交易完成后等待 10 分钟
2025-05-29 17:46:26,037 - TradingBot - INFO - 日志初始化成功，当前日志文件: logs\trading_2025-05-29.log
2025-05-29 17:46:26,037 - TradingBot - INFO - 交易程序启动，进入日内多次换仓模式
2025-05-29 17:46:26,469 - TradingBot - INFO - Binance 客户端初始化成功，测试网络: False
2025-05-29 17:46:26,788 - TradingBot - INFO - 所有交易对已是全仓模式 (CROSSED)，无需修改
2025-05-29 17:46:26,906 - TradingBot - INFO - 账户已是单币种模式 (Single)，无需修改
2025-05-29 17:46:27,028 - TradingBot - INFO - 账户已是单向模式 (One-way)，无需修改
2025-05-29 17:46:27,556 - TradingBot - INFO - 检查 20250529 的文件或邮件，Run_ID: 2025-05-29_174627
2025-05-29 17:46:27,556 - TradingBot - INFO - 检查本地文件: data/pos20250529_v3.csv
2025-05-29 17:46:27,556 - TradingBot - INFO - 本地找到文件 data/pos20250529_v3.csv，哈希: f15f859a3ed30157e3a3be2755a85d1b，未处理，直接使用
2025-05-29 17:46:27,557 - TradingBot - INFO - 处理 20250529 的pos文件，Run_ID: 2025-05-29_174627
2025-05-29 17:46:27,557 - TradingBot - INFO - 🚀 开始执行交易引擎 | Date: 20250529 | RunID: 2025-05-29_174627
2025-05-29 17:46:27,673 - TradingBot - INFO - 当前没有未成交的挂单
2025-05-29 17:46:27,679 - TradingBot - INFO - 📋 黑名单过滤结果
├─ 被过滤币种 (7个): BADGERUSDT, BALUSDT, LINAUSDT, NULSUSDT, SNTUSDT, TROYUSDT, VIDTUSDT
└─ 剩余候选池: 166/173
2025-05-29 17:46:27,684 - TradingBot - INFO - 🔍 有效候选列表
├─ 多头候选: 82个
└─ 空头候选: 84个
2025-05-29 17:46:27,961 - TradingBot - INFO - =====账户信息获取成功: totalMarginBalance = 47.84358375, available_balance = 5.86450361=====
2025-05-29 17:46:27,961 - TradingBot - INFO - 每笔交易资金份额: per_share=3.060255982142857
2025-05-29 17:46:28,080 - TradingBot - INFO - 获取到 14 个非零持仓
2025-05-29 17:46:28,080 - TradingBot - INFO - 当前持仓: {'TRXUSDT': 33.0, 'PROMUSDT': 1.7, 'CRVUSDT': -11.6, 'FLMUSDT': -192.0, 'OMUSDT': -23.4, 'MKRUSDT': 0.005, 'DOGEUSDT': 41.0, 'DASHUSDT': -0.368, 'KAVAUSDT': 21.8, 'IOSTUSDT': 2381.0, 'AERGOUSDT': -60.0, 'XRPUSDT': 4.0, 'DFUSDT': -177.0, 'CAKEUSDT': -3.0}, 是否第一天: False
2025-05-29 17:46:28,252 - TradingBot - INFO - 交易所信息获取成功
2025-05-29 17:46:28,806 - TradingBot - WARNING - BTCUSDT 数量调整为 0 (原值: 0 小于最小值: 0.001)
2025-05-29 17:46:28,806 - TradingBot - WARNING - BTCUSDT 数量调整为 0 (因名义价值 0.0 小于最小值 100.0)
2025-05-29 17:46:28,806 - TradingBot - INFO - BTCUSDT 数量调整: 8.473744155339508e-05 -> 0, 最小值: 0.001, 最大值: 1000.0, 名义价值=0.0, 真实保证金=0.000000, 数量精度=3
2025-05-29 17:46:28,807 - TradingBot - WARNING - BTCUSDT 数量调整为 0，跳过
2025-05-29 17:46:29,275 - TradingBot - INFO - MKRUSDT 数量调整: 0.005272061528901212 -> 0.005, 最小值: 0.001, 最大值: 10000.0, 名义价值=8.707, 真实保证金=2.902333, 数量精度=3
2025-05-29 17:46:29,275 - TradingBot - INFO - 添加多头目标: MKRUSDT, 数量=0.005
2025-05-29 17:46:30,301 - TradingBot - INFO - DOGEUSDT 数量调整: 40.75269862583705 -> 41.0, 最小值: 1.0, 最大值: 50000000.0, 名义价值=9.23648, 真实保证金=3.078827, 数量精度=0
2025-05-29 17:46:30,301 - TradingBot - INFO - 添加多头目标: DOGEUSDT, 数量=41.0
2025-05-29 17:46:30,726 - TradingBot - INFO - KAVAUSDT 数量调整: 21.719346927912397 -> 21.7, 最小值: 0.1, 最大值: 1000000.0, 名义价值=9.17259, 真实保证金=3.057530, 数量精度=1
2025-05-29 17:46:30,727 - TradingBot - INFO - 添加多头目标: KAVAUSDT, 数量=21.7
2025-05-29 17:46:30,727 - TradingBot - WARNING - 交易对 KEYUSDT 不可交易，跳过
2025-05-29 17:46:30,727 - TradingBot - WARNING - 交易对 STPTUSDT 不可交易，跳过
2025-05-29 17:46:30,727 - TradingBot - WARNING - 交易对 AMBUSDT 不可交易，跳过
2025-05-29 17:46:30,727 - TradingBot - WARNING - 交易对 REEFUSDT 不可交易，跳过
2025-05-29 17:46:30,727 - TradingBot - WARNING - 交易对 SCUSDT 不可交易，跳过
2025-05-29 17:46:31,154 - TradingBot - INFO - TRXUSDT 数量调整: 33.191496552525564 -> 33.0, 最小值: 1.0, 最大值: 10000000.0, 名义价值=9.1278, 真实保证金=3.042600, 数量精度=0
2025-05-29 17:46:31,155 - TradingBot - INFO - 添加多头目标: TRXUSDT, 数量=33.0
2025-05-29 17:46:31,155 - TradingBot - WARNING - 交易对 SLPUSDT 不可交易，跳过
2025-05-29 17:46:31,155 - TradingBot - WARNING - 交易对 DGBUSDT 不可交易，跳过
2025-05-29 17:46:31,155 - TradingBot - WARNING - 交易对 MDTUSDT 不可交易，跳过
2025-05-29 17:46:31,155 - TradingBot - WARNING - 交易对 RENUSDT 不可交易，跳过
2025-05-29 17:46:31,731 - TradingBot - INFO - IOSTUSDT 数量调整: 2388.337134866954 -> 2388.0, 最小值: 1.0, 最大值: 80000000.0, 名义价值=9.179472, 真实保证金=3.059824, 数量精度=0
2025-05-29 17:46:31,732 - TradingBot - INFO - 添加多头目标: IOSTUSDT, 数量=2388.0
2025-05-29 17:46:32,210 - TradingBot - INFO - PROMUSDT 数量调整: 1.7074145334626318 -> 1.7, 最小值: 0.1, 最大值: 100000.0, 名义价值=9.1409, 真实保证金=3.046967, 数量精度=1
2025-05-29 17:46:32,211 - TradingBot - INFO - 添加多头目标: PROMUSDT, 数量=1.7
2025-05-29 17:46:32,641 - TradingBot - INFO - XRPUSDT 数量调整: 4.005920213992744 -> 4.0, 最小值: 0.1, 最大值: 10000000.0, 名义价值=9.1672, 真实保证金=3.055733, 数量精度=1
2025-05-29 17:46:32,643 - TradingBot - INFO - 添加多头目标: XRPUSDT, 数量=4.0
2025-05-29 17:46:33,071 - TradingBot - INFO - AERGOUSDT 数量调整: 62.96823008524396 -> 63.0, 最小值: 1.0, 最大值: 4000000.0, 名义价值=9.185400000000001, 真实保证金=3.061800, 数量精度=0
2025-05-29 17:46:33,072 - TradingBot - INFO - 添加空头目标: AERGOUSDT, 数量=-63.0
2025-05-29 17:46:33,851 - TradingBot - INFO - FLMUSDT 数量调整: 192.0662750298864 -> 192.0, 最小值: 1.0, 最大值: 15000000.0, 名义价值=9.1776, 真实保证金=3.059200, 数量精度=0
2025-05-29 17:46:33,852 - TradingBot - INFO - 添加空头目标: FLMUSDT, 数量=-192.0
2025-05-29 17:46:34,298 - TradingBot - INFO - OMUSDT 数量调整: 23.40003044917309 -> 23.4, 最小值: 0.1, 最大值: 10000000.0, 名义价值=9.180756, 真实保证金=3.060252, 数量精度=1
2025-05-29 17:46:34,299 - TradingBot - INFO - 添加空头目标: OMUSDT, 数量=-23.4
2025-05-29 17:46:34,761 - TradingBot - INFO - DASHUSDT 数量调整: 0.3868844478056709 -> 0.387, 最小值: 0.001, 最大值: 10000.0, 名义价值=9.18351, 真实保证金=3.061170, 数量精度=3
2025-05-29 17:46:34,762 - TradingBot - INFO - 添加空头目标: DASHUSDT, 数量=-0.387
2025-05-29 17:46:35,200 - TradingBot - INFO - CRVUSDT 数量调整: 11.665524709566164 -> 11.7, 最小值: 0.1, 最大值: 1000000.0, 名义价值=9.2079, 真实保证金=3.069300, 数量精度=1
2025-05-29 17:46:35,201 - TradingBot - INFO - 添加空头目标: CRVUSDT, 数量=-11.7
2025-05-29 17:46:35,621 - TradingBot - INFO - CAKEUSDT 数量调整: 3.290715777063182 -> 3.0, 最小值: 1.0, 最大值: 1000000.0, 名义价值=8.3697, 真实保证金=2.789900, 数量精度=0
2025-05-29 17:46:35,622 - TradingBot - INFO - 添加空头目标: CAKEUSDT, 数量=-3.0
2025-05-29 17:46:36,050 - TradingBot - WARNING - BCHUSDT 数量调整为 0 (因名义价值 9.300939999999999 小于最小值 20.0)
2025-05-29 17:46:36,050 - TradingBot - INFO - BCHUSDT 数量调整: 0.021715750754378434 -> 0, 最小值: 0.001, 最大值: 10000.0, 名义价值=0.0, 真实保证金=0.000000, 数量精度=3
2025-05-29 17:46:36,051 - TradingBot - WARNING - BCHUSDT 数量调整为 0，跳过
2025-05-29 17:46:36,482 - TradingBot - INFO - DFUSDT 数量调整: 183.98332557973086 -> 184.0, 最小值: 1.0, 最大值: 5000000.0, 名义价值=9.1816, 真实保证金=3.060533, 数量精度=0
2025-05-29 17:46:36,483 - TradingBot - INFO - 添加空头目标: DFUSDT, 数量=-184.0
2025-05-29 17:46:36,483 - TradingBot - INFO - 初始化目标持仓: {'MKRUSDT': 0.005, 'DOGEUSDT': 41.0, 'KAVAUSDT': 21.7, 'TRXUSDT': 33.0, 'IOSTUSDT': 2388.0, 'PROMUSDT': 1.7, 'XRPUSDT': 4.0, 'AERGOUSDT': -63.0, 'FLMUSDT': -192.0, 'OMUSDT': -23.4, 'DASHUSDT': -0.387, 'CRVUSDT': -11.7, 'CAKEUSDT': -3.0, 'DFUSDT': -184.0}
2025-05-29 17:46:36,597 - TradingBot - INFO - 获取到 14 个非零持仓
2025-05-29 17:46:36,598 - TradingBot - INFO - ==================== 开始持续限价单调仓 ====================
2025-05-29 17:46:36,598 - TradingBot - INFO - 开始第 1 轮调仓...
2025-05-29 17:46:36,726 - TradingBot - INFO - 第 1 轮开始时可用余额: 5.85535887
2025-05-29 17:46:36,856 - TradingBot - INFO - 第 1 轮: 处理平仓 KAVAUSDT SELL, 需求数量=0.10000000000000142
2025-05-29 17:46:37,274 - TradingBot - INFO - KAVAUSDT 平仓数量调整: 0.10000000000000142 -> 0.1, 最小值: 0.1, 最大值: 1000000.0, 名义价值=0.04229, 真实保证金=0.014097, 数量精度=1
2025-05-29 17:46:37,274 - TradingBot - INFO - 第 1 轮: KAVAUSDT 平仓调整后数量=0.1
2025-05-29 17:46:37,274 - TradingBot - INFO - 第 1 轮: KAVAUSDT 为平仓操作，跳过余额检查
2025-05-29 17:46:37,390 - TradingBot - INFO - 第 1 轮: 准备平仓挂单 KAVAUSDT SELL, 数量=0.1, 价格=0.4229, is_close=True
2025-05-29 17:46:37,506 - TradingBot - INFO - KAVAUSDT 杠杆设置为 3
2025-05-29 17:46:37,506 - TradingBot - INFO - KAVAUSDT 杠杆已设置为 3, is_close=True
2025-05-29 17:46:37,659 - TradingBot - INFO - KAVAUSDT 为平仓订单 (reduceOnly=True)，跳过保证金检查
2025-05-29 17:46:37,775 - TradingBot - INFO - KAVAUSDT postonly 挂单成功: 方向=SELL, 数量=0.1, 价格=0.4229, 订单ID=11202955934, is_close=True, reduceOnly=True
2025-05-29 17:46:37,892 - TradingBot - INFO - 第 1 轮: KAVAUSDT 平仓挂单结果 success=True, order_id=11202955934, order={'orderId': 11202955934, 'symbol': 'KAVAUSDT', 'status': 'NEW', 'clientOrderId': 'x-Cb7ytekJf54d051e485bb7c04285c8', 'price': '0.4229', 'avgPrice': '0.00', 'origQty': '0.1', 'executedQty': '0.0', 'cumQty': '0.0', 'cumQuote': '0.00000', 'timeInForce': 'GTX', 'type': 'LIMIT', 'reduceOnly': True, 'closePosition': False, 'side': 'SELL', 'positionSide': 'BOTH', 'stopPrice': '0.0000', 'workingType': 'CONTRACT_PRICE', 'priceProtect': False, 'origType': 'LIMIT', 'priceMatch': 'NONE', 'selfTradePreventionMode': 'EXPIRE_MAKER', 'goodTillDate': 0, 'updateTime': 1748511997751}
2025-05-29 17:46:37,892 - TradingBot - INFO - 第 1 轮: KAVAUSDT SELL postOnly 平仓挂单成功，订单ID=11202955934, is_close=True
2025-05-29 17:46:37,892 - TradingBot - INFO - 第 1 轮开仓前可用余额: 5.85535887, 开仓需求: {'DFUSDT': -7.0, 'AERGOUSDT': -3.0, 'KAVAUSDT': 0.0, 'DASHUSDT': -0.019000000000000017, 'CRVUSDT': -0.09999999999999964, 'IOSTUSDT': 7.0}
2025-05-29 17:46:37,892 - TradingBot - INFO - 第 1 轮: 处理开仓 DFUSDT SELL, 需求数量=-7.0
2025-05-29 17:46:39,516 - TradingBot - WARNING - DFUSDT 数量调整为 0 (因名义价值 0.34923000000000004 小于最小值 5.0)
2025-05-29 17:46:39,516 - TradingBot - INFO - DFUSDT 数量调整: 7.0 -> 0, 最小值: 1.0, 最大值: 5000000.0, 名义价值=0.0, 真实保证金=0.000000, 数量精度=0
2025-05-29 17:46:39,517 - TradingBot - INFO - 第 1 轮: DFUSDT 开仓调整后数量=0, is_reverse_open=False
2025-05-29 17:46:39,517 - TradingBot - WARNING - 第 1 轮: DFUSDT 调整数量为 0，跳过
2025-05-29 17:46:39,517 - TradingBot - INFO - 第 1 轮: 处理开仓 AERGOUSDT SELL, 需求数量=-3.0
2025-05-29 17:46:39,946 - TradingBot - WARNING - AERGOUSDT 数量调整为 0 (因名义价值 0.43713 小于最小值 5.0)
2025-05-29 17:46:39,947 - TradingBot - INFO - AERGOUSDT 数量调整: 3.0 -> 0, 最小值: 1.0, 最大值: 4000000.0, 名义价值=0.0, 真实保证金=0.000000, 数量精度=0
2025-05-29 17:46:39,947 - TradingBot - INFO - 第 1 轮: AERGOUSDT 开仓调整后数量=0, is_reverse_open=False
2025-05-29 17:46:39,947 - TradingBot - WARNING - 第 1 轮: AERGOUSDT 调整数量为 0，跳过
2025-05-29 17:46:39,947 - TradingBot - INFO - 第 1 轮: 跳过 KAVAUSDT 开仓，原因：数量为0或已处理
2025-05-29 17:46:39,947 - TradingBot - INFO - 第 1 轮: 处理开仓 DASHUSDT SELL, 需求数量=-0.019000000000000017
2025-05-29 17:46:40,459 - TradingBot - WARNING - DASHUSDT 数量调整为 0 (因名义价值 0.45106 小于最小值 5.0)
2025-05-29 17:46:40,460 - TradingBot - INFO - DASHUSDT 数量调整: 0.019000000000000017 -> 0, 最小值: 0.001, 最大值: 10000.0, 名义价值=0.0, 真实保证金=0.000000, 数量精度=3
2025-05-29 17:46:40,461 - TradingBot - INFO - 第 1 轮: DASHUSDT 开仓调整后数量=0, is_reverse_open=False
2025-05-29 17:46:40,461 - TradingBot - WARNING - 第 1 轮: DASHUSDT 调整数量为 0，跳过
2025-05-29 17:46:40,461 - TradingBot - INFO - 第 1 轮: 处理开仓 CRVUSDT SELL, 需求数量=-0.09999999999999964
2025-05-29 17:46:40,896 - TradingBot - WARNING - CRVUSDT 数量调整为 0 (因名义价值 0.0787 小于最小值 5.0)
2025-05-29 17:46:40,897 - TradingBot - INFO - CRVUSDT 数量调整: 0.09999999999999964 -> 0, 最小值: 0.1, 最大值: 1000000.0, 名义价值=0.0, 真实保证金=0.000000, 数量精度=1
2025-05-29 17:46:40,898 - TradingBot - INFO - 第 1 轮: CRVUSDT 开仓调整后数量=0, is_reverse_open=False
2025-05-29 17:46:40,898 - TradingBot - WARNING - 第 1 轮: CRVUSDT 调整数量为 0，跳过
2025-05-29 17:46:40,898 - TradingBot - INFO - 第 1 轮: 处理开仓 IOSTUSDT BUY, 需求数量=7.0
2025-05-29 17:46:41,333 - TradingBot - WARNING - IOSTUSDT 数量调整为 0 (因名义价值 0.026900999999999998 小于最小值 5.0)
2025-05-29 17:46:41,333 - TradingBot - INFO - IOSTUSDT 数量调整: 7.0 -> 0, 最小值: 1.0, 最大值: 80000000.0, 名义价值=0.0, 真实保证金=0.000000, 数量精度=0
2025-05-29 17:46:41,335 - TradingBot - INFO - 第 1 轮: IOSTUSDT 开仓调整后数量=0, is_reverse_open=False
2025-05-29 17:46:41,335 - TradingBot - WARNING - 第 1 轮: IOSTUSDT 调整数量为 0，跳过
2025-05-29 17:46:41,335 - TradingBot - INFO - 第 1 轮挂单等待，最多 30 秒...
2025-05-29 17:47:13,214 - TradingBot - INFO - 第 1 轮结束，取消所有未成交挂单...
2025-05-29 17:47:13,335 - TradingBot - INFO - 第 1 轮: 发现 1 个未成交订单
2025-05-29 17:47:13,820 - TradingBot - INFO - 成功取消 KAVAUSDT 订单，订单ID=11202955934
2025-05-29 17:47:13,820 - TradingBot - INFO - 第 1 轮: 成功取消 KAVAUSDT SELL 挂单，订单ID=11202955934
2025-05-29 17:47:13,945 - TradingBot - INFO - 获取到 14 个非零持仓
2025-05-29 17:47:14,604 - TradingBot - INFO - DFUSDT 平仓数量调整: 7.0 -> 7.0, 最小值: 1.0, 最大值: 5000000.0, 名义价值=0.34902, 真实保证金=0.116340, 数量精度=0
2025-05-29 17:47:14,605 - TradingBot - INFO - 第 1 轮: DFUSDT 差值 -7.0 为小额调整（名义价值 0.34902 < 5 或数量过小），跳过后续轮次
2025-05-29 17:47:15,034 - TradingBot - INFO - AERGOUSDT 平仓数量调整: 3.0 -> 3.0, 最小值: 1.0, 最大值: 4000000.0, 名义价值=0.43713, 真实保证金=0.145710, 数量精度=0
2025-05-29 17:47:15,034 - TradingBot - INFO - 第 1 轮: AERGOUSDT 差值 -3.0 为小额调整（名义价值 0.43713 < 5 或数量过小），跳过后续轮次
2025-05-29 17:47:15,454 - TradingBot - INFO - KAVAUSDT 平仓数量调整: 0.10000000000000142 -> 0.1, 最小值: 0.1, 最大值: 1000000.0, 名义价值=0.042280000000000005, 真实保证金=0.014093, 数量精度=1
2025-05-29 17:47:15,455 - TradingBot - INFO - 第 1 轮: KAVAUSDT 差值 -0.10000000000000142 为小额调整（名义价值 0.042280000000000005 < 5 或数量过小），跳过后续轮次
2025-05-29 17:47:15,875 - TradingBot - INFO - DASHUSDT 平仓数量调整: 0.019000000000000017 -> 0.019, 最小值: 0.001, 最大值: 10000.0, 名义价值=0.45067999999999997, 真实保证金=0.150227, 数量精度=3
2025-05-29 17:47:15,876 - TradingBot - INFO - 第 1 轮: DASHUSDT 差值 -0.019000000000000017 为小额调整（名义价值 0.45067999999999997 < 5 或数量过小），跳过后续轮次
2025-05-29 17:47:16,297 - TradingBot - INFO - CRVUSDT 平仓数量调整: 0.09999999999999964 -> 0.1, 最小值: 0.1, 最大值: 1000000.0, 名义价值=0.0787, 真实保证金=0.026233, 数量精度=1
2025-05-29 17:47:16,297 - TradingBot - INFO - 第 1 轮: CRVUSDT 差值 -0.09999999999999964 为小额调整（名义价值 0.0787 < 5 或数量过小），跳过后续轮次
2025-05-29 17:47:16,716 - TradingBot - INFO - IOSTUSDT 平仓数量调整: 7.0 -> 7.0, 最小值: 1.0, 最大值: 80000000.0, 名义价值=0.026908, 真实保证金=0.008969, 数量精度=0
2025-05-29 17:47:16,717 - TradingBot - INFO - 第 1 轮: IOSTUSDT 差值 7.0 为小额调整（名义价值 0.026908 < 5 或数量过小），跳过后续轮次
2025-05-29 17:47:16,717 - TradingBot - INFO - 第 1 轮完成，剩余需求: {}
2025-05-29 17:47:16,717 - TradingBot - INFO - 第 1 轮后所有目标已达成，结束限价单调仓
2025-05-29 17:47:16,717 - TradingBot - INFO - ==================== 市价单补齐：后续调仓 ====================
2025-05-29 17:47:16,835 - TradingBot - INFO - 获取到 14 个非零持仓
2025-05-29 17:47:16,836 - TradingBot - INFO - 市价单补齐：所有目标已达成，无需补齐
2025-05-29 17:47:38,884 - TradingBot - INFO - 账户信息已保存为JSON文件: data/account_info_20250529_174738.json
2025-05-29 17:47:38,954 - TradingBot - WARNING - 无法解析当前记录时间: 2025-05-29_17:47:38，使用当前时间作为默认值
2025-05-29 17:47:38,961 - TradingBot - INFO - 找到上一次记录: Record_Time=2025-05-29 17:42:13, after_trade_balance=47.87720679
2025-05-29 17:47:38,962 - TradingBot - INFO - Pre-rebalance return: -0.070228%
2025-05-29 17:47:38,962 - TradingBot - WARNING - 无法计算 Post-rebalance return: 缺少上一次 after_trade_balance 数据或数据无效
2025-05-29 17:47:39,482 - TradingBot - INFO - 成功写入 14 条指标到 data/account_metrics.xlsx，Run_ID=2025-05-29_174627
2025-05-29 17:47:39,483 - TradingBot - INFO - ✅ 交易引擎执行完成 | RunID: 2025-05-29_174627
2025-05-29 17:47:39,483 - TradingBot - INFO - 当前日期: 2025-05-29, Run_ID: 2025-05-29_174627
2025-05-29 17:47:39,486 - TradingBot - INFO - 读取 data/positions_output.csv，去重后包含 123 条记录
2025-05-29 17:47:39,487 - TradingBot - INFO - 找到 0 条 Run_ID=2025-05-29_174627 或日期=2025-05-29 的记录
2025-05-29 17:47:39,487 - TradingBot - INFO - 当前 Run_ID 无持仓数据，创建空结果
2025-05-29 17:47:39,487 - TradingBot - INFO - 正持仓数量: 0, 负持仓数量: 0
2025-05-29 17:47:39,488 - TradingBot - INFO - 资金费率文件 data/pos20250529_v3.csv 已加载，去重后包含 173 条记录
2025-05-29 17:47:39,489 - TradingBot - INFO - 已为 7 个黑名单币种设置 ErrorReason: 黑名单过滤
2025-05-29 17:47:39,490 - TradingBot - INFO - 已为 17 个币种映射其他错误原因
2025-05-29 17:47:39,492 - TradingBot - INFO - 无有效持仓数据，生成空结果
2025-05-29 17:47:39,559 - TradingBot - INFO - 分析结果已去重并追加写入文件: data/position_analysis.xlsx，记录数: 237
2025-05-29 17:47:39,612 - TradingBot - INFO - 唯一日期数量为 8，执行可视化...
2025-05-29 17:47:39,697 - TradingBot - INFO - 添加附件: data\position_analysis.xlsx
2025-05-29 17:47:39,697 - TradingBot - INFO - 未找到可视化 PDF 文件: data\2025-05-29_account_metrics_data_visualization.pdf
2025-05-29 17:47:39,711 - TradingBot - INFO - 尝试连接到 smtp.gmail.com:465 (第 1/5)
2025-05-29 17:48:00,774 - TradingBot - ERROR - 发送邮件失败 (第 1/5): [WinError 10060] 由于连接方在一段时间后没有正确答复或连接的主机没有反应，连接尝试失败。
2025-05-29 17:48:00,774 - TradingBot - INFO - 等待 10 秒后重试...
2025-05-29 17:48:10,777 - TradingBot - INFO - 尝试连接到 smtp.gmail.com:465 (第 2/5)
2025-05-29 17:48:31,825 - TradingBot - ERROR - 发送邮件失败 (第 2/5): [WinError 10060] 由于连接方在一段时间后没有正确答复或连接的主机没有反应，连接尝试失败。
2025-05-29 17:48:31,825 - TradingBot - INFO - 等待 10 秒后重试...
2025-05-29 17:48:41,836 - TradingBot - INFO - 尝试连接到 smtp.gmail.com:465 (第 3/5)
2025-05-29 17:49:02,875 - TradingBot - ERROR - 发送邮件失败 (第 3/5): [WinError 10060] 由于连接方在一段时间后没有正确答复或连接的主机没有反应，连接尝试失败。
2025-05-29 17:49:02,875 - TradingBot - INFO - 等待 10 秒后重试...
2025-05-29 17:49:12,882 - TradingBot - INFO - 尝试连接到 smtp.gmail.com:465 (第 4/5)
2025-05-29 17:49:33,936 - TradingBot - ERROR - 发送邮件失败 (第 4/5): [WinError 10060] 由于连接方在一段时间后没有正确答复或连接的主机没有反应，连接尝试失败。
2025-05-29 17:49:33,936 - TradingBot - INFO - 等待 10 秒后重试...
2025-05-29 17:49:43,937 - TradingBot - INFO - 尝试连接到 smtp.gmail.com:465 (第 5/5)
2025-05-29 17:49:44,776 - TradingBot - INFO - 连接成功，开始登录
2025-05-29 17:49:48,229 - TradingBot - INFO - 邮件发送成功！
2025-05-29 17:49:48,435 - TradingBot - INFO - 20250529 交易完成，Run_ID: 2025-05-29_174627
2025-05-29 17:49:48,435 - TradingBot - INFO - 记录已处理文件 data/pos20250529_v3.csv，哈希: f15f859a3ed30157e3a3be2755a85d1b，Run_ID: 2025-05-29_174627
2025-05-29 17:49:48,435 - TradingBot - INFO - 交易完成后等待 10 分钟
2025-05-29 17:59:48,443 - TradingBot - INFO - 检查 20250529 的文件或邮件，Run_ID: 2025-05-29_175948
2025-05-29 17:59:48,443 - TradingBot - INFO - 检查本地文件: data/pos20250529_v3.csv
2025-05-29 17:59:48,448 - TradingBot - INFO - 文件 data/pos20250529_v3.csv 已处理（哈希: f15f859a3ed30157e3a3be2755a85d1b），跳过
2025-05-29 17:59:48,448 - TradingBot - INFO - 未收到 20250529 的pos文件，等待 10 分钟后重试
2025-05-29 18:09:48,452 - TradingBot - INFO - 检查 20250529 的文件或邮件，Run_ID: 2025-05-29_180948
2025-05-29 18:09:48,452 - TradingBot - INFO - 检查本地文件: data/pos20250529_v3.csv
2025-05-29 18:09:48,453 - TradingBot - INFO - 文件 data/pos20250529_v3.csv 已处理（哈希: f15f859a3ed30157e3a3be2755a85d1b），跳过
2025-05-29 18:09:48,453 - TradingBot - INFO - 未收到 20250529 的pos文件，等待 10 分钟后重试
2025-05-29 18:19:48,459 - TradingBot - INFO - 检查 20250529 的文件或邮件，Run_ID: 2025-05-29_181948
2025-05-29 18:19:48,459 - TradingBot - INFO - 检查本地文件: data/pos20250529_v3.csv
2025-05-29 18:19:48,459 - TradingBot - INFO - 文件 data/pos20250529_v3.csv 已处理（哈希: f15f859a3ed30157e3a3be2755a85d1b），跳过
2025-05-29 18:19:48,459 - TradingBot - INFO - 未收到 20250529 的pos文件，等待 10 分钟后重试
